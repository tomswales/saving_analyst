(this.webpackJsonpsaving_analyst=this.webpackJsonpsaving_analyst||[]).push([[0],{29:function(e,t,a){e.exports=a(40)},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),o=a.n(c),s=a(1),i=a(5),l=a(4),u=a.n(l),m=a(11),d=a.n(m);var g=function(e){const t=Object(n.useRef)(null),a=new d.a;return r.a.createElement("div",{className:"transaction-list-controls-container"},r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.clearTransactions())},"Clear transactions"),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.generateCategoryMapping())},"Export transaction categories"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;a&&a.length>0&&e.importCategoryMappings(a[0])}(t),ref:t,type:"file",accept:".json"}),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:e=>(e.preventDefault(),void t.current.click())},"Import transaction categories")),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Show only uncategorised"),r.a.createElement("input",{type:"checkbox",checked:e.filterClassified,onChange:t=>{return a=t,void e.setFilterClassified(a.target.checked);var a}})),e.filterClassified?null:r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by category"),r.a.createElement("select",{value:e.filterByCategory,onChange:t=>{return a=t,void e.setCategoryFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),e.categoryList.map(e=>r.a.createElement("option",{key:a.string({length:16}),value:e},e)))),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by transaction type"),r.a.createElement("select",{value:e.filterByTransactionType,onChange:t=>{return a=t,void e.setTransactionTypeFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),r.a.createElement("option",{value:"Expenditure"},"Expenditure"),r.a.createElement("option",{value:"Income"},"Income"))))))};var p=function(e){const t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(""),l=Object(i.a)(s,2),u=l[0],m=l[1];if(c){const t=e.getPrediction(e.transaction.id);return r.a.createElement("div",{className:"category-editor"},0===u.length&&e.categoryList.length>0?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Select a category"),r.a.createElement("select",{value:e.category,onChange:t=>{return a=t,e.updateCategoryForMatchingItems(e.transaction.id,a.target.value),void g();var a}},r.a.createElement("option",{value:"Undefined"},"None"),e.categoryList.map(t=>r.a.createElement("option",{key:t+" "+e.transaction.id,value:t},t)))):null,r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Create a new category"),r.a.createElement("input",{value:u,onChange:e=>{m(e.target.value)},type:"text",placeholder:"Enter category name"})),u.length>0?r.a.createElement("button",{onClick:t=>(e.updateCategoryForMatchingItems(e.transaction.id,u),void g()),className:"pure-button pure-button-primary"},"Save category"):null,t&&t[0]?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Suggestion: ",t[0].category),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:()=>{return a=t[0].category,e.updateCategoryForMatchingItems(e.transaction.id,a),void g();var a}},"Confirm")):null,r.a.createElement("div",{className:"category-editor-button-spacer"}),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void g()),className:"pure-button"},"Cancel"))}return r.a.createElement("div",{className:"category-editor"},"Undefined"!==e.category?r.a.createElement("div",{className:"category-editor"},r.a.createElement("div",{className:"category-name"},e.category),r.a.createElement("button",{onClick:e=>d(!0,e),className:"pure-button"},"Edit category")):r.a.createElement("div",{className:"category-editor"},r.a.createElement("button",{onClick:e=>d(!0,e),className:"pure-button pure-button-primary"},"Add category")));function d(e,t){o(e)}function g(){o(!1),m("")}};var f=function(e){const t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],o=a[1];return r.a.createElement("div",{className:"delete-control"},c?r.a.createElement("div",{className:"confirm-delete-container"},r.a.createElement("p",null,r.a.createElement("b",null,"Delete?")),r.a.createElement("button",{onClick:t=>(t.preventDefault(),e.deleteTransaction(e.transactionId),void o(!1)),className:"pure-button pure-button-primary"},"Yes"),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void o(!1)),className:"pure-button"},"No")):r.a.createElement("i",{onClick:e=>{o(!0)},className:"fas fa-times delete-icon"}))};var y=function(e){return r.a.createElement("div",{className:"transaction-row"},r.a.createElement(f,{deleteTransaction:e.deleteTransaction,transactionId:e.transaction.id,stateOwner:e.stateOwner}),r.a.createElement("div",{className:"transaction-data-container"},r.a.createElement("div",{className:"transaction-data-head"},r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Counterparty")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Beguenstigter/Zahlungspflichtiger"])),r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Amount")),r.a.createElement("div",{className:e.transaction.amount>=0?"transaction-text":"transaction-text negative"},e.transaction.Waehrung,": ",e.transaction.amount))),r.a.createElement("div",{className:"transaction-data-body"},r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Date")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstag)),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"IBAN")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Kontonummer/IBAN"])),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Transaction type")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstext)))),r.a.createElement("div",{className:"transaction-category-container"},r.a.createElement(p,{updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,transaction:e.transaction,category:e.transaction.category,categoryList:e.categoryList,getPrediction:e.getPrediction})))};var v=function(e){return r.a.createElement("div",{className:"pure-menu pure-menu-horizontal"},r.a.createElement("ul",{className:"pure-menu-list"},r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"DATE_ASC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_ASC"):e.setSortBy("DATE_DESC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-up"})));case"DATE_DESC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_DESC"):e.setSortBy("DATE_ASC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})));default:return r.a.createElement("div",{onClick:()=>("DATE_ASC"!==e.sortBy&&e.sortBy,e.setSortBy("DATE_DESC")),className:"pure-menu-link"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})))}}()),r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"AMT_ASC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_ASC"):e.setSortBy("AMT_DESC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-up"})));case"AMT_DESC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})));default:return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})))}}())))};var E=function(e){return r.a.createElement("div",{className:"transaction-list"},e.sortedTransactions.length>0?r.a.createElement(v,{setSortBy:e.setSortBy,sortBy:e.sortBy}):null,e.sortedTransactions.length>0?r.a.createElement("p",null,"Displaying ",e.sortedTransactions.slice(0,e.displayLimit).length," of ",e.transactionLength," total transactions"):null,e.sortedTransactions.slice(0,e.displayLimit).map(t=>r.a.createElement(y,{deleteTransaction:e.deleteTransaction,categoryList:e.categoryList,key:t.id,transaction:t,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,getPrediction:e.getPrediction})))};var b=function(e){const t=Object(n.useRef)(null),a=function({transactions:e}){return e.reduce((e,t)=>e.find(e=>e===t.category)||"Undefined"===t.category?e:e.concat([t.category]),[]).sort()}({transactions:e.transactions}),c=function({transactions:e,filterClassified:t,filterByCategory:a,filterByTransactionType:n}){const r=t?e.filter(e=>"Undefined"===e.category):e,c=""!==a?r.filter(e=>e.category===a):r;return""!==n?c.filter(e=>"Income"===n?e.amount>=0:"Expenditure"===n?e.amount<0:e):c}({transactions:e.transactions,filterClassified:e.filterClassified,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType}),o=function({sortBy:t,transactions:a}){return a.concat([]).sort((t,a)=>{const n=u()(t.bookingDate),r=u()(a.bookingDate);switch(e.sortBy){case"DATE_ASC":return n.isBefore(r)?-1:r.isBefore(n)?1:0;case"DATE_DESC":return r.isBefore(n)?-1:n.isBefore(r)?1:0;case"AMT_ASC":return t.amount-a.amount;case"AMT_DESC":return a.amount-t.amount;default:return u()(a.bookingDate).utc()}})}({sortBy:e.sortBy,transactions:c});return r.a.createElement("div",{className:"transactions-container"},r.a.createElement("h2",null,"Transactions"),e.transactions.length>0?r.a.createElement(g,{categoryList:a,filterClassified:e.filterClassified,setCategoryFilter:e.setCategoryFilter,setTransactionTypeFilter:e.setTransactionTypeFilter,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType,clearTransactions:e.clearTransactions,generateCategoryMapping:e.generateCategoryMapping,importCategoryMappings:e.importCategoryMappings,setFilterClassified:e.setFilterClassified}):r.a.createElement("div",null,r.a.createElement("p",null,"Import your transactions"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;if(a&&a.length>0){const t=window.URL.createObjectURL(a[0]);e.importTransactions(t)}}(t),ref:t,type:"file",accept:".csv"}),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:e=>(e.preventDefault(),void t.current.click())},"Click to import")),r.a.createElement(E,{sortedTransactions:o,setSortBy:e.setSortBy,sortBy:e.sortBy,displayLimit:e.displayLimit,transactionLength:e.transactions.length,deleteTransaction:e.deleteTransaction,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,categoryList:a,getPrediction:e.getPrediction}),o.length>e.displayLimit?r.a.createElement("div",{className:"more-button-container"},r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:t=>(t.preventDefault(),void e.showMoreTransactions())},"Show more")):null)};var h=function(e){return r.a.createElement("div",{className:"management-panel-menu-bar"},r.a.createElement("div",{onClick:e=>t("Transactions",e),className:"Transactions"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Transactions"),r.a.createElement("i",{className:"far fa-list-alt fa-1x"})),r.a.createElement("div",{onClick:e=>t("Reports",e),className:"Reports"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Reports"),r.a.createElement("i",{className:"far fa-chart-bar fa-1x"})));function t(t,a){e.setRoute(t)}},N=a(23),C=a(3),B=a.n(C);var S=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),c=[{label:"Income",data:e.data.map(e=>e.income),backgroundColor:"#000000"},{label:"Expenditure",data:e.data.map(e=>e.expenditure),backgroundColor:"#ff0000"},{label:"Net savings",data:e.data.map(e=>e.total),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],o=n.getContext("2d"),s=new B.a(o,{type:"bar",data:{labels:r,datasets:c},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=s}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Income versus Expenditure by Month"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))};var T=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),c=[{label:"Cumulative savings",data:e.data.map(e=>e.savedTotal),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],o=n.getContext("2d"),s=new B.a(o,{type:"bar",data:{labels:r,datasets:c},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=s}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Cumulative Savings"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))},A=a(12);var w=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,c=A("mpn65",50),o=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+c[t%50]})),s=n.getContext("2d"),i=new B.a(s,{type:"bar",data:{labels:r,datasets:o},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Expenditure by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))},D=a(22),O=a.n(D);var M=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=function(e,t,a,n){const r=12*function(e){const t=e.reduce((e,t)=>{let a;return e.length>0?(a=e[e.length-1]+t.total,e.concat([a])):e.concat([t.total])},[0]).map((e,t)=>[t,e]);return O.a.linear(t)}(e).equation[0];return function(e,t,a,n,r){return function e(t,a,n,r,c,o,s,i){if(s===r||t>c)return i;{const l=t+n,u=Math.round(a+a*o+n),m=s+1,d=i.concat({year:m,balance:l,balanceWithInterest:u});return e(l,u,n,r,c,o,m,d)}}(e,e,t,a,n,0===r?0:r/100,0,[{year:0,balance:e,balanceWithInterest:e}])}(t,r,50,a,n)}(e.data,e.currentBalance,e.savingGoal,e.interestRate),r=t.current,c=n.map(e=>"Year "+e.year),o=e.savingGoal;e.savingGoal&&function(e,t,a,n,r,c){const o=[{label:"Projected savings",data:e.map(e=>e.balance),backgroundColor:"#000000",borderColor:"#000000",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:"With ".concat(c,"% interest"),data:e.map(e=>e.balanceWithInterest),backgroundColor:"#D3D3D3",borderColor:"#D3D3D3",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:"Savings goal",data:e.map(e=>n),borderColor:"#ff0000",backgroundColor:"#ff0000",type:"line",fill:!1,pointRadius:0}],s=t.getContext("2d"),i=new B.a(s,{type:"bar",data:{labels:a,datasets:o},options:{scales:{yAxes:[{ticks:{beginAtZero:!0,max:Math.round(1.1*parseFloat(n))}}]},maintainAspectRatio:!1,responsive:!0,animation:!1}});r.current=i}(n,r,c,o,a,e.interestRate)}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Savings Projection"),r.a.createElement("div",{className:"chart-container"},e.savingGoal?r.a.createElement("canvas",{ref:t}):r.a.createElement("div",null,"You need to provide a saving goal")))};var j=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,c=A("mpn65",50),o=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+c[t%50]})),s=n.getContext("2d"),i=new B.a(s,{type:"bar",data:{labels:r,datasets:o},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Income by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};function k(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}function x(e){const t=e.map(e=>[e,0]);return new Map(t)}var R=function(e){const t=function(){const t=isNaN(parseFloat(e.currentBalance))?0:parseFloat(e.currentBalance),a=isNaN(parseFloat(e.otherSavingsBalance))?0:parseFloat(e.otherSavingsBalance);return t+a}(),a=isNaN(parseFloat(e.savingGoal))?0:parseFloat(e.savingGoal),c=isNaN(parseFloat(e.interestRate))?0:parseFloat(e.interestRate),o=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>{const a=u()(t.bookingDate).month(),n=u()(t.bookingDate).year(),r=parseFloat(t.amount);if(e.get(n)){const c=e.get(n);if(c.get(a)){const e=c.get(a),n=e.income,o=e.expenditure,i=e.total,l=e.transactions.concat([t]),u=r>=0?Object(s.a)({},e,{income:k(n+r,2),total:k(i+r,2),transactions:l}):Object(s.a)({},e,{expenditure:k(o+r,2),total:k(i+r,2),transactions:l});c.set(a,u)}else{const c=r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t]}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t]};e.get(n).set(a,c)}}else{const c=r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t]}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t]};e.set(n,new Map),e.get(n).set(a,c)}return e},new Map),[e.transactions]),i=Array.prototype.concat.apply([],Array.from(o.values()).map(e=>Array.from(e.values()))),l=Object(n.useMemo)(()=>function(e,t,a){const n=e.reduce((e,t,a)=>e+t.total,0).toFixed(2),r=e.length,c=e.length>0?(n/r).toFixed(2):0,o=a&&t&&a>0?(t/a*100).toFixed(1):0;return{totalSaving:n,averageSaving:c,percentSaved:o}}(i,t,a),[i,t,a]),m=Object(n.useMemo)(()=>function(e,t){const a=e.reduce((e,t)=>e+t.total,0),n=t-a;return e.reduce((e,t,a)=>{if(0===e.length)return e.concat([{year:t.year,month:t.month,savedTotal:k(t.total+n,2)}]);{const a=e[e.length-1].savedTotal;return e.concat([{year:t.year,month:t.month,savedTotal:k(a+t.total,2)}])}},[])}(i,t),[i,t]),d=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>e.find(e=>e===t.category)?e:e.concat([t.category]),[]).sort(),[e.transactions]),g=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>function(e,t){const a=x(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount<0){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>0-t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(i,d),[i,d]),p=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>function(e,t){const a=x(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount>0){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(i,d),[i,d]);return r.a.createElement("div",{className:"reports-container"},r.a.createElement("h2",null,"Reports"),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Current balance (EUR)"),r.a.createElement("input",{type:"number",value:e.currentBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setCurrentBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Other savings (EUR)"),r.a.createElement("input",{type:"number",value:e.otherSavingsBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setOtherSavingsBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Saving goal (EUR)"),r.a.createElement("input",{type:"number",value:e.savingGoal,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setSavingGoal(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Interest rate (%)"),r.a.createElement("div",{className:"interest-rate-slider"},r.a.createElement("input",{type:"range",min:"0",max:"100",step:"1",value:e.interestRate,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setInterestRate(t.target.value)}(t)}),r.a.createElement("div",{className:"rate-display"},e.interestRate,"%"))))),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Saving summary"),r.a.createElement("div",{className:"stat-container"},r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",l.totalSaving),r.a.createElement("div",{className:"stat-text"},"Saved during period")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",l.averageSaving),r.a.createElement("div",{className:"stat-text"},"Average monthly saving")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},l.percentSaved," %"),r.a.createElement("div",{className:"stat-text"},"Towards savings target")))),r.a.createElement(S,{data:i}),r.a.createElement(T,{data:m}),r.a.createElement(M,{data:i,currentBalance:t,savingGoal:a,interestRate:c}),r.a.createElement(w,{data:g}),r.a.createElement(j,{data:p}))};function F(e){return e.reduce((e,t)=>(e.get(t.referenceString)||"Undefined"===t.category||e.set(t.referenceString,t.category),e),new Map)}function I(e){return e.replace(/\/\//g," ").replace(/\/\//g," ").replace(/%/g," ").replace(/\./g," ").split(" ").filter(e=>""!==e)}var _=function(e){const t=Object(n.useRef)(null),a=Object(n.useState)({transactions:[],currentBalance:"",otherSavingsBalance:"0",savingGoal:"",interestRate:"0",storedCategoryMappings:new Map}),c=Object(i.a)(a,2),o=c[0],l=c[1],m=Object(n.useState)("Transactions"),g=Object(i.a)(m,2),p=g[0],f=g[1],y=Object(n.useState)({transactionDisplayLimit:50,filterClassified:!1,filterByCategory:"",filterByTransactionType:"",sortBy:"DATE_DESC"}),v=Object(i.a)(y,2),E=v[0],C=v[1],B=Object(n.useState)(null),S=Object(i.a)(B,2),T=S[0],A=S[1];return Object(n.useEffect)(()=>{try{const e=function(){try{const e=window.localStorage.getItem("savedState"),t=e?JSON.parse(e):{};return Object(s.a)({},o,{transactions:e?t.transactions:[],currentBalance:e?t.currentBalance:"",otherSavingsBalance:e?t.otherSavingsBalance:"",savingGoal:e?t.savingGoal:"",interestRate:e?t.interestRate:"0",storedCategoryMappings:e?new Map(t.storedCategoryMappings):new Map})}catch(e){console.log("Error retrieving from local storage",e.message)}}();l(e)}catch(e){console.log("Error applying state from local storage to running application ",e.message)}q(o.transactions)},[]),r.a.createElement("div",{className:"app-page app-content"},r.a.createElement("a",{className:"hidden-input",href:"hidden",ref:t},"Hidden data download link"),r.a.createElement("div",{className:"app-header"},r.a.createElement("div",{className:"app-logo-container"},"Saving Analyst")),r.a.createElement("div",{className:"app-main-content"},r.a.createElement("div",{className:"management-panel"},r.a.createElement(h,{setRoute:function(e){f(e)},route:p}),r.a.createElement("div",{className:"management-panel-content"},function(){switch(p){case"Transactions":return r.a.createElement(b,{displayLimit:E.transactionDisplayLimit,transactions:o.transactions,filterByCategory:E.filterByCategory,filterClassified:E.filterClassified,filterByTransactionType:E.filterByTransactionType,currentBalance:o.currentBalance,otherSavingsBalance:o.otherSavingsBalance,savingGoal:o.savingGoal,sortBy:o.sortBy,setSortBy:K,importTransactions:D,importCategoryMappings:k,clearTransactions:O,generateCategoryMapping:j,showMoreTransactions:U,setFilterClassified:Z,setCategoryFilter:P,setTransactionTypeFilter:J,deleteTransaction:M,updateCategoryForMatchingItems:W,getPrediction:z});case"Reports":return r.a.createElement(R,{state:o,transactions:o.transactions,currentBalance:o.currentBalance,otherSavingsBalance:o.otherSavingsBalance,interestRate:o.interestRate,savingGoal:o.savingGoal,setSavingGoal:L,setInterestRate:G,setCurrentBalance:x,setOtherSavingsBalance:_});default:return r.a.createElement("div",null,"Something went wrong!")}}()))));function w(e){try{l(e)}catch(t){return void console.log("Error saving state",t.message)}try{!function(e){try{const t={transactions:e.transactions,currentBalance:e.currentBalance,otherSavingsBalance:e.otherSavingsBalance,savingGoal:e.savingGoal,interestRate:e.interestRate,storedCategoryMappings:Array.from(e.storedCategoryMappings.entries())};window.localStorage.setItem("savedState",JSON.stringify(t))}catch(t){console.log("Error saving state to local storage",t.message)}}(e)}catch(t){return void console.log("Error saving to local storage",t.message)}}function D(e){try{N.a(e).then(e=>{const t=function(e){const t=new d.a;return e.map(e=>{let a;a=""!==e["Beguenstigter/Zahlungspflichtiger"]&&""!==e["Kontonummer/IBAN"]?e["Beguenstigter/Zahlungspflichtiger"]+"%"+e["Kontonummer/IBAN"]:e.Buchungstext;const n=t.string({length:25}),r=u.a.utc(e.Buchungstag,"DD.MM.YY"),c=e.Betrag.replace(/,/g,".");return Object(s.a)({},e,{id:n,amount:parseFloat(c).toFixed(2),referenceString:a,bookingDate:r.toDate(),category:"Undefined"})}).sort((e,t)=>e.bookingDate.valueOf()-t.bookingDate.valueOf())}(e),a=(n=o.storedCategoryMappings,t.map(e=>n.get(e.referenceString)?Object(s.a)({},e,{category:n.get(e.referenceString)}):Object(s.a)({},e,{category:"Undefined"})));var n;w(Object(s.a)({},o,{transactions:a})),q(a)})}catch(t){console.log("Transaction import failed"+t.message)}}function O(){try{w(Object(s.a)({},o,{transactions:[],currentBalance:"",otherSavingsBalance:"",savingGoal:"",storedCategoryMappings:new Map})),Y(),A(null)}catch(e){console.log("Error clearing transactions",e.message)}}function M(e){try{const t=o.transactions.filter(t=>t.id!==e);w(Object(s.a)({},o,{transactions:t}))}catch(t){console.log("Error deleting transaction",t.message)}}function j(){try{const e="data:text/json,"+encodeURIComponent(JSON.stringify(Array.from(F(o.transactions).entries()))),a="data "+(new Date).toLocaleString()+".json",n=t.current;n.href=e,n.download=a,n.click()}catch(e){console.log("Error generating category download file: ",e.message)}}function k(e){const t=new FileReader;t.onload=e=>{const a=JSON.parse(t.result);!function(t){if(t)try{var a;const e=null===(a=o.transactions)||void 0===a?void 0:a.map(e=>t.get(e.referenceString)?Object(s.a)({},e,{category:t.get(e.referenceString)}):e);if(!e)throw new Error("transactions were undefined");w(Object(s.a)({},o,{transactions:e})),q(e)}catch(e){return void console.log("Error applying category mappings",e.message)}else console.log("no category map found!")}(new Map(a))};try{t.readAsText(e)}catch(a){console.log("Error reading file: ",a.message)}}function x(e){w(Object(s.a)({},o,{currentBalance:e}))}function _(e){w(Object(s.a)({},o,{otherSavingsBalance:e}))}function L(e){w(Object(s.a)({},o,{savingGoal:e}))}function G(e){w(Object(s.a)({},o,{interestRate:e}))}function U(){const e=Object(s.a)({},E,{transactionDisplayLimit:E.transactionDisplayLimit+50});C(e)}function P(e){const t=Object(s.a)({},E,{filterByCategory:e});C(t)}function Z(e){const t=Object(s.a)({},E,{filterClassified:e,filterByCategory:""});C(t)}function J(e){const t=Object(s.a)({},E,{filterByTransactionType:e});C(t)}function W(e,t){var a;const n=null===(a=o.transactions)||void 0===a?void 0:a.find(t=>t.id===e);if(n){const e=o.transactions.map(e=>e.referenceString===n.referenceString?Object(s.a)({},e,{category:t}):e),a=F(e);w(Object(s.a)({},o,{transactions:e,storedCategoryMappings:a})),Y(),q(e)}}function Y(){const e=Object(s.a)({},E,{transactionDisplayLimit:50,filterByCategory:""});C(e)}function K(e){const t=Object(s.a)({},o,{sortBy:e});l(t)}function q(e){const t=function(e){const t=function(e){return e.map(e=>({id:e.id,transactionType:e.Buchungstext,words:I(e["Beguenstigter/Zahlungspflichtiger"]),category:e.category}))}(e.filter(e=>"Undefined"!==e.category)),a=function(e){return e.reduce((e,t)=>e.includes(t.category)?e:e.concat([t.category]),[])}(t),n=function(e){const t=e.length,a=e.reduce((e,t)=>{if(e.has(t.category)){const a=e.get(t.category)+1;return e.set(t.category,a),e}return e.set(t.category,1),e},new Map);return new Map(Array.from(a).map(e=>[e[0],e[1]/t]))}(t),r=function(e){const t=(e,t)=>{const a=e.find(e=>e.word===t);if(a){const t=a.count++;return a.count=t,e}return e.concat([{word:t,count:1}])};return e.reduce((e,a)=>a.words.reduce(t,e),[])}(t),c=function(e,t,a){const n=((e,t,a)=>{const n=new Map;return t.forEach(t=>{let r=0;a.forEach(a=>{e.filter(e=>e.category===a&&e.words.includes(t.word)).length>0&&r++}),n.set(t.word,r)}),n})(e,t,a),r=new Map;return a.forEach(a=>{r.set(a,new Map);const c=e.filter(e=>e.category===a),o=c.length;t.forEach(e=>{const t=(c.filter(t=>t.words.includes(e.word)).length+.01)/o*(1/n.get(e.word));r.get(a).set(e.word,t)})}),r}(t,r,a),o=function(e){return e.reduce((e,t)=>e.includes(t.transactionType)?e:e.concat([t.transactionType]),[])}(t),s=function(e,t,a){const n=new Map;return a.forEach(a=>{n.set(a,new Map);const r=e.filter(e=>e.category===a),c=r.length;t.forEach(e=>{const t=(1+r.filter(t=>t.transactionType===e).length)/c;n.get(a).set(e,t)})}),n}(t,o,a);return e=>{if(e&&e.words){return a.map(t=>{const a=n.get(t),r=function e(a,n){if(0===a.length)return 0;if(1===a.length)return c.get(t).get(a[0])?n*c.get(t).get(a[0]):n;if(c.get(t).get(a[0])){const r=n*c.get(t).get(a[0]);return e(a.slice(1),r)}return e(a.slice(1),n)}(e.words,1);const o=s.get(t).get(e.transactionType);return{category:t,probability:a*r*o}}).sort((e,t)=>t.probability-e.probability).slice(0,1)}return{}}}(e);t&&"function"===typeof t&&A(()=>t)}function z(e){const t=o.transactions.find(t=>t.id===e),a={id:t.id,words:I(t["Beguenstigter/Zahlungspflichtiger"]),category:t.category,transactionType:t.Buchungstext};if(a){if("function"===typeof T){return T(a)}return{}}return{}}};o.a.render(r.a.createElement(_,null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.9136d5e9.chunk.js.map