(this.webpackJsonpsaving_analyst=this.webpackJsonpsaving_analyst||[]).push([[0],{28:function(e,t,a){e.exports=a(39)},39:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(19),c=a.n(s),o=a(3),i=a.n(o),l=a(10),u=a.n(l);var m=function(e){const t=Object(n.useRef)(null),a=new u.a;return r.a.createElement("div",{className:"transaction-list-controls-container"},r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.clearTransactions())},"Clear transactions"),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.generateCategoryMapping())},"Export transaction categories"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;a&&a.length>0&&e.importCategoryMappings(a[0])}(t),ref:t,type:"file",accept:".json"}),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:e=>(e.preventDefault(),void t.current.click())},"Import transaction categories")),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Show only uncategorised"),r.a.createElement("input",{type:"checkbox",checked:e.filterClassified,onChange:t=>{return a=t,void e.setFilterClassified(a.target.checked);var a}})),e.filterClassified?null:r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by category"),r.a.createElement("select",{value:e.filterByCategory,onChange:t=>{return a=t,void e.setCategoryFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),e.categoryList.map(e=>r.a.createElement("option",{key:a.string({length:16}),value:e},e)))),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by transaction type"),r.a.createElement("select",{value:e.filterByTransactionType,onChange:t=>{return a=t,void e.setTransactionTypeFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),r.a.createElement("option",{value:"Expenditure"},"Expenditure"),r.a.createElement("option",{value:"Income"},"Income"))),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by savings transfer"),r.a.createElement("input",{type:"checkbox",checked:e.filterBySavingsTransfer,onChange:t=>{return a=t,void e.setSavingsTransferFilter(a.target.checked);var a}})))))};var d=function(e){const[t,a]=Object(n.useState)(!1),[s,c]=Object(n.useState)("");if(t){const t=e.getPrediction(e.transaction.id);return r.a.createElement("div",{className:"category-editor"},0===s.length&&e.categoryList.length>0?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Select a category"),r.a.createElement("select",{value:e.category,onChange:t=>{return a=t,e.updateCategoryForMatchingItems(e.transaction.id,a.target.value),void i();var a}},r.a.createElement("option",{value:"Undefined"},"None"),e.categoryList.map(t=>r.a.createElement("option",{key:t+" "+e.transaction.id,value:t},t)))):null,r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Create a new category"),r.a.createElement("input",{value:s,onChange:e=>{c(e.target.value)},type:"text",placeholder:"Enter category name"})),s.length>0?r.a.createElement("button",{onClick:t=>(e.updateCategoryForMatchingItems(e.transaction.id,s),void i()),className:"pure-button pure-button-primary"},"Save category"):null,t&&t[0]?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Suggestion: ",t[0].category),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:()=>{return a=t[0].category,e.updateCategoryForMatchingItems(e.transaction.id,a),void i();var a}},"Confirm")):null,r.a.createElement("div",{className:"category-editor-button-spacer"}),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void i()),className:"pure-button"},"Cancel"))}return r.a.createElement("div",{className:"category-editor"},"Undefined"!==e.category?r.a.createElement("div",{className:"category-editor"},r.a.createElement("div",{className:"category-name"},e.category),r.a.createElement("button",{onClick:e=>o(!0,e),className:"pure-button"},"Edit category")):r.a.createElement("div",{className:"category-editor"},r.a.createElement("button",{onClick:e=>o(!0,e),className:"pure-button pure-button-primary"},"Add category")));function o(e,t){a(e)}function i(){a(!1),c("")}};var g=function(e){const[t,a]=Object(n.useState)(!1);return r.a.createElement("div",{className:"delete-control"},t?r.a.createElement("div",{className:"confirm-delete-container"},r.a.createElement("p",null,r.a.createElement("b",null,"Delete?")),r.a.createElement("button",{onClick:t=>(t.preventDefault(),e.deleteTransaction(e.transactionId),void a(!1)),className:"pure-button pure-button-primary"},"Yes"),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void a(!1)),className:"pure-button"},"No")):r.a.createElement("i",{onClick:e=>{a(!0)},className:"fas fa-times delete-icon"}))};var p=function(e){return r.a.createElement("div",{className:"transaction-row"},r.a.createElement(g,{deleteTransaction:e.deleteTransaction,transactionId:e.transaction.id,stateOwner:e.stateOwner}),r.a.createElement("div",{className:"transaction-data-container"},r.a.createElement("div",{className:"transaction-data-head"},r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Counterparty")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Beguenstigter/Zahlungspflichtiger"])),r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Amount")),r.a.createElement("div",{className:e.transaction.amount>=0?"transaction-text":"transaction-text negative"},e.transaction.Waehrung,": ",e.transaction.amount))),r.a.createElement("div",{className:"transaction-data-body"},r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Date")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstag)),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"IBAN")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Kontonummer/IBAN"])),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Transaction type")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstext)),r.a.createElement("div",{className:"transaction-data-body-item"},e.transaction.amount<0?r.a.createElement("div",null,r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Savings")),r.a.createElement("div",{className:"transaction-text"},r.a.createElement("input",{type:"checkbox",checked:e.transaction.isSaving,onChange:t=>function(t,a){e.updateTransactionIsSaving(a,t.target.checked)}(t,e.transaction.id)}))):null))),r.a.createElement("div",{className:"transaction-category-container"},r.a.createElement(d,{updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,transaction:e.transaction,category:e.transaction.category,categoryList:e.categoryList,getPrediction:e.getPrediction})))};var f=function(e){return r.a.createElement("div",{className:"pure-menu pure-menu-horizontal"},r.a.createElement("ul",{className:"pure-menu-list"},r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"DATE_ASC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_ASC"):e.setSortBy("DATE_DESC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-up"})));case"DATE_DESC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_DESC"):e.setSortBy("DATE_ASC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})));default:return r.a.createElement("div",{onClick:()=>("DATE_ASC"!==e.sortBy&&e.sortBy,e.setSortBy("DATE_DESC")),className:"pure-menu-link"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})))}}()),r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"AMT_ASC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_ASC"):e.setSortBy("AMT_DESC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-up"})));case"AMT_DESC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})));default:return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})))}}())))};var y=function(e){return r.a.createElement("div",{className:"transaction-list"},e.sortedTransactions.length>0?r.a.createElement(f,{setSortBy:e.setSortBy,sortBy:e.sortBy}):null,e.sortedTransactions.length>0?r.a.createElement("p",null,"Displaying ",e.sortedTransactions.slice(0,e.displayLimit).length," of ",e.transactionLength," total transactions"):null,e.sortedTransactions.slice(0,e.displayLimit).map(t=>r.a.createElement(p,{updateTransactionIsSaving:e.updateTransactionIsSaving,deleteTransaction:e.deleteTransaction,categoryList:e.categoryList,key:t.id,transaction:t,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,getPrediction:e.getPrediction})))};var v=function(e){const t=Object(n.useRef)(null),a=function(e){let{transactions:t}=e;return t.reduce((e,t)=>e.find(e=>e===t.category)||"Undefined"===t.category?e:e.concat([t.category]),[]).sort()}({transactions:e.transactions}),s=function(e){let{transactions:t,filterClassified:a,filterByCategory:n,filterByTransactionType:r,filterBySavingsTransfer:s}=e;const c=a?t.filter(e=>"Undefined"===e.category):t,o=""!==n?c.filter(e=>e.category===n):c,i=""!==r?o.filter(e=>"Income"===r?e.amount>=0:"Expenditure"===r?e.amount<0:e):o;return s?i.filter(e=>e.isSaving):i}({transactions:e.transactions,filterClassified:e.filterClassified,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType,filterBySavingsTransfer:e.filterBySavingsTransfer}),c=function(t){let{sortBy:a,transactions:n}=t;return n.concat([]).sort((t,a)=>{const n=i()(t.bookingDate),r=i()(a.bookingDate);switch(e.sortBy){case"DATE_ASC":return n.isBefore(r)?-1:r.isBefore(n)?1:0;case"DATE_DESC":return r.isBefore(n)?-1:n.isBefore(r)?1:0;case"AMT_ASC":return t.amount-a.amount;case"AMT_DESC":return a.amount-t.amount;default:return i()(a.bookingDate).utc()}})}({sortBy:e.sortBy,transactions:s});return r.a.createElement("div",{className:"transactions-container"},r.a.createElement("h2",null,"Transactions"),e.transactions.length>0?r.a.createElement(m,{categoryList:a,filterClassified:e.filterClassified,setCategoryFilter:e.setCategoryFilter,setTransactionTypeFilter:e.setTransactionTypeFilter,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType,clearTransactions:e.clearTransactions,generateCategoryMapping:e.generateCategoryMapping,importCategoryMappings:e.importCategoryMappings,setFilterClassified:e.setFilterClassified,setSavingsTransferFilter:e.setSavingsTransferFilter,filterBySavingsTransfer:e.filterBySavingsTransfer}):r.a.createElement("div",null,r.a.createElement("p",null,"Import your transactions"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;if(a&&a.length>0){const t=window.URL.createObjectURL(a[0]);e.importTransactions(t)}}(t),ref:t,type:"file",accept:".csv"}),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:e=>(e.preventDefault(),void t.current.click())},"Click to import")),r.a.createElement(y,{sortedTransactions:c,setSortBy:e.setSortBy,sortBy:e.sortBy,displayLimit:e.displayLimit,transactionLength:e.transactions.length,deleteTransaction:e.deleteTransaction,updateTransactionIsSaving:e.updateTransactionIsSaving,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,categoryList:a,getPrediction:e.getPrediction}),c.length>e.displayLimit?r.a.createElement("div",{className:"more-button-container"},r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:t=>(t.preventDefault(),void e.showMoreTransactions())},"Show more")):null)};var E=function(e){return r.a.createElement("div",{className:"management-panel-menu-bar"},r.a.createElement("div",{onClick:e=>t("Transactions",e),className:"Transactions"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Transactions"),r.a.createElement("i",{className:"far fa-list-alt fa-1x"})),r.a.createElement("div",{onClick:e=>t("Reports",e),className:"Reports"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Reports"),r.a.createElement("i",{className:"far fa-chart-bar fa-1x"})));function t(t,a){e.setRoute(t)}},b=a(22),h=a(2),N=a.n(h);var C=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),s=[{label:"Income",data:e.data.map(e=>e.income),backgroundColor:"#000000"},{label:"Expenditure",data:e.data.map(e=>e.expenditure),backgroundColor:"#ff0000"},{label:"Net savings",data:e.data.map(e=>e.total),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],c=n.getContext("2d"),o=new N.a(c,{type:"bar",data:{labels:r,datasets:s},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=o}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Income versus Expenditure by Month"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))};var S=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),s=[{label:"Cumulative savings",data:e.data.map(e=>e.savedTotal),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],c=n.getContext("2d"),o=new N.a(c,{type:"bar",data:{labels:r,datasets:s},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=o}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Cumulative Savings"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))},B=a(4);var T=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,s=B("mpn65",50),c=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+s[t%50]})),o=n.getContext("2d"),i=new N.a(o,{type:"bar",data:{labels:r,datasets:c},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Monthly expenditure by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))},A=a(20),w=a.n(A);var M=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=function(e,t,a,n){const r=12*function(e){const t=e.reduce((e,t)=>{let a;return e.length>0?(a=e[e.length-1]+t.total,e.concat([a])):e.concat([t.total])},[0]).map((e,t)=>[t,e]);return w.a.linear(t)}(e).equation[0];return function(e,t,a,n,r){return function e(t,a,n,r,s,c,o,i){if(o===r||t>s)return i;{const l=t+n,u=Math.round(a+a*c+n),m=o+1,d=i.concat({year:m,balance:l,balanceWithInterest:u});return e(l,u,n,r,s,c,m,d)}}(e,e,t,a,n,0===r?0:r/100,0,[{year:0,balance:e,balanceWithInterest:e}])}(t,r,50,a,n)}(e.data,e.currentBalance,e.savingGoal,e.interestRate),r=t.current,s=n.map(e=>"Year "+e.year),c=e.savingGoal;e.savingGoal&&function(e,t,a,n,r,s){const c=[{label:"Projected savings",data:e.map(e=>e.balance),backgroundColor:"#000000",borderColor:"#000000",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:`With ${s}% interest`,data:e.map(e=>e.balanceWithInterest),backgroundColor:"#D3D3D3",borderColor:"#D3D3D3",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:"Savings goal",data:e.map(e=>n),borderColor:"#ff0000",backgroundColor:"#ff0000",type:"line",fill:!1,pointRadius:0}],o=t.getContext("2d"),i=new N.a(o,{type:"bar",data:{labels:a,datasets:c},options:{scales:{yAxes:[{ticks:{beginAtZero:!0,max:Math.round(1.1*parseFloat(n))}}]},maintainAspectRatio:!1,responsive:!0,animation:!1}});r.current=i}(n,r,s,c,a,e.interestRate)}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Savings Projection"),r.a.createElement("div",{className:"chart-container"},e.savingGoal?r.a.createElement("canvas",{ref:t}):r.a.createElement("div",null,"You need to provide a saving goal")))};var k=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,s=B("mpn65",50),c=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+s[t%50]})),o=n.getContext("2d"),i=new N.a(o,{type:"bar",data:{labels:r,datasets:c},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Monthly income by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};var D=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e[0]),s=B("mpn65",50),c={label:"Overall expenditure",data:e.data.map(e=>e[1]),backgroundColor:s.map(e=>"#"+e)},o=n.getContext("2d"),i=new N.a(o,{type:"doughnut",data:{labels:r,datasets:[c]}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Overall expenditure by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};var x=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e[0]),s=B("mpn65",50),c={label:"Overall income",data:e.data.map(e=>e[1]),backgroundColor:s.map(e=>"#"+e)},o=n.getContext("2d"),i=new N.a(o,{type:"doughnut",data:{labels:r,datasets:[c]}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Overall income by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};function O(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}function R(e){const t=e.map(e=>[e,0]);return new Map(t)}function F(e,t){const a=R(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount<0&&!t.isSaving){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}function j(e,t){const a=R(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount>0){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}var I=function(e){const t=function(){const t=isNaN(parseFloat(e.currentBalance))?0:parseFloat(e.currentBalance),a=isNaN(parseFloat(e.otherSavingsBalance))?0:parseFloat(e.otherSavingsBalance);return t+a}(),a=isNaN(parseFloat(e.savingGoal))?0:parseFloat(e.savingGoal),s=isNaN(parseFloat(e.interestRate))?0:parseFloat(e.interestRate),c=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>{const a=i()(t.bookingDate).month(),n=i()(t.bookingDate).year(),r=parseFloat(t.amount),s=t.isSaving,c=s?O(0-r,2):0;let o;if(e.get(n)){const i=e.get(n);if(i.get(a)){const e=i.get(a),n=e.income,l=e.expenditure,u=e.total,m=e.transactions.concat([t]);if(s){const t=e.transferred;o={...e,transferred:O(t+c,2),transactions:m}}else o=r>=0?{...e,income:O(n+r,2),total:O(u+r,2),transactions:m}:{...e,expenditure:O(l+r,2),total:O(u+r,2),transactions:m};i.set(a,o)}else o=s?{year:n,month:a,income:0,expenditure:0,total:0,transactions:[t],transferred:c}:r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t],transferred:0}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t],transferred:0},e.get(n).set(a,o)}else o=s?{year:n,month:a,income:0,expenditure:0,total:0,transactions:[t],transferred:c}:r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t],transferred:0}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t],transferred:0},e.set(n,new Map),e.get(n).set(a,o);return e},new Map),[e.transactions]),o=Array.prototype.concat.apply([],Array.from(c.values()).map(e=>Array.from(e.values()))),l=Object(n.useMemo)(()=>function(e,t,a){const n=e.reduce((e,t,a)=>e+t.total,0).toFixed(2),r=e.reduce((e,t,a)=>e+t.transferred,0),s=e.length,c=e.length>0?(n/s).toFixed(2):0,o=a&&t&&a>0?((t+r)/a*100).toFixed(1):0;return{totalSaving:n,averageSaving:c,percentSaved:o,totalTransferred:r}}(o,t,a),[o,t,a]),u=Object(n.useMemo)(()=>function(e,t){const a=e.reduce((e,t)=>e+t.total,0),n=e.reduce((e,t)=>e+t.transferred,0),r=O(t-a+n,2);return e.reduce((e,t,a)=>{if(0===e.length)return e.concat([{year:t.year,month:t.month,savedTotal:O(t.total+r,2)}]);{const a=e[e.length-1].savedTotal;return e.concat([{year:t.year,month:t.month,savedTotal:O(a+t.total,2)}])}},[])}(o,t),[o,t]),m=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>e.find(e=>e===t.category)?e:e.concat([t.category]),[]).sort(),[e.transactions]),d=Object(n.useMemo)(()=>function(e,t){return Array.from(F(e,t).entries()).sort((e,t)=>e[1]-t[1])}(e.transactions,m),[e.transactions,m]),g=Object(n.useMemo)(()=>function(e,t){return Array.from(j(e,t).entries()).filter(e=>e[1]>0).sort((e,t)=>t[1]-e[1])}(e.transactions,m),[e.transactions,m]),p=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>F(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>0-t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(o,m),[o,m]),f=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>j(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(o,m),[o,m]);return r.a.createElement("div",{className:"reports-container"},r.a.createElement("h2",null,"Reports"),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Current balance (EUR)"),r.a.createElement("input",{type:"number",value:e.currentBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setCurrentBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Other savings (EUR)"),r.a.createElement("input",{type:"number",value:e.otherSavingsBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setOtherSavingsBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Saving goal (EUR)"),r.a.createElement("input",{type:"number",value:e.savingGoal,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setSavingGoal(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Interest rate (%)"),r.a.createElement("div",{className:"interest-rate-slider"},r.a.createElement("input",{type:"range",min:"0",max:"100",step:"1",value:e.interestRate,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setInterestRate(t.target.value)}(t)}),r.a.createElement("div",{className:"rate-display"},e.interestRate,"%"))))),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Saving summary"),r.a.createElement("div",{className:"stat-container"},r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",l.totalSaving),r.a.createElement("div",{className:"stat-text"},"Saved during period")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",l.averageSaving),r.a.createElement("div",{className:"stat-text"},"Average monthly saving")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},l.percentSaved," %"),r.a.createElement("div",{className:"stat-text"},"Towards savings target")))),r.a.createElement(C,{data:o}),r.a.createElement(S,{data:u}),r.a.createElement(M,{data:o,currentBalance:t+l.totalTransferred,savingGoal:a,interestRate:s}),r.a.createElement(D,{data:d}),r.a.createElement(T,{data:p}),r.a.createElement(x,{data:g}),r.a.createElement(k,{data:f}))},_=a(21);function L(e){return e.reduce((e,t)=>(e.get(t.referenceString)||"Undefined"===t.category||e.set(t.referenceString,t.category),e),new Map)}function G(e){return e.filter(e=>e.isSaving).map(e=>{const t=e.bookingDate,a=e.amount;return[JSON.stringify(e.referenceString+"-"+t+"-"+a),e.isSaving]})}function U(e){return e.replace(/\/\//g," ").replace(/\/\//g," ").replace(/%/g," ").replace(/\./g," ").split(" ").filter(e=>""!==e)}var P=function(e){const t=async()=>await Object(_.a)("saving_analyst",1,{upgrade(e){e.createObjectStore("transactions")}}),a=async e=>(await t()).get("transactions",e),s=async(e,a)=>(await t()).put("transactions",a,e),c=Object(n.useRef)(null),[o,l]=Object(n.useState)({transactions:[],currentBalance:"",otherSavingsBalance:"0",savingGoal:"",interestRate:"0",storedCategoryMappings:new Map}),[m,d]=Object(n.useState)("Transactions"),[g,p]=Object(n.useState)({transactionDisplayLimit:50,filterClassified:!1,filterByCategory:"",filterByTransactionType:"",sortBy:"DATE_DESC",filterBySavingsTransfer:!1}),[f,y]=Object(n.useState)(null);return Object(n.useEffect)(()=>{try{!async function(){const e=await async function(){try{console.log("Here");const e=await a("savedState"),t=e?JSON.parse(e):{};return{...o,transactions:e?t.transactions:[],currentBalance:e?t.currentBalance:"",otherSavingsBalance:e?t.otherSavingsBalance:"",savingGoal:e?t.savingGoal:"",interestRate:e?t.interestRate:"0",storedCategoryMappings:e?new Map(t.storedCategoryMappings):new Map}}catch(e){console.log("Error retrieving from local storage",e.message)}}();l(e),W(e.transactions)}()}catch(e){console.log("Error applying state from local storage to running application ",e.message)}},[]),r.a.createElement("div",{className:"app-page app-content"},r.a.createElement("a",{className:"hidden-input",href:"hidden",ref:c},"Hidden data download link"),r.a.createElement("div",{className:"app-header"},r.a.createElement("div",{className:"app-logo-container"},"Saving Analyst")),r.a.createElement("div",{className:"app-main-content"},r.a.createElement("div",{className:"management-panel"},r.a.createElement(E,{setRoute:function(e){d(e)},route:m}),r.a.createElement("div",{className:"management-panel-content"},function(){switch(m){case"Transactions":return r.a.createElement(v,{displayLimit:g.transactionDisplayLimit,transactions:o.transactions,filterByCategory:g.filterByCategory,filterClassified:g.filterClassified,filterByTransactionType:g.filterByTransactionType,filterBySavingsTransfer:g.filterBySavingsTransfer,currentBalance:o.currentBalance,otherSavingsBalance:o.otherSavingsBalance,savingGoal:o.savingGoal,sortBy:o.sortBy,setSortBy:Z,importTransactions:N,importCategoryMappings:T,clearTransactions:C,generateCategoryMapping:B,showMoreTransactions:D,setFilterClassified:O,setCategoryFilter:x,setTransactionTypeFilter:R,deleteTransaction:S,updateCategoryForMatchingItems:P,updateTransactionIsSaving:j,getPrediction:Y,setSavingsTransferFilter:F});case"Reports":return r.a.createElement(I,{state:o,transactions:o.transactions,currentBalance:o.currentBalance,otherSavingsBalance:o.otherSavingsBalance,interestRate:o.interestRate,savingGoal:o.savingGoal,setSavingGoal:M,setInterestRate:k,setCurrentBalance:A,setOtherSavingsBalance:w});default:return r.a.createElement("div",null,"Something went wrong!")}}()))));function h(e){try{l(e)}catch(t){return void console.log("Error saving state",t.message)}try{!async function(e){try{const t={transactions:e.transactions,currentBalance:e.currentBalance,otherSavingsBalance:e.otherSavingsBalance,savingGoal:e.savingGoal,interestRate:e.interestRate,storedCategoryMappings:Array.from(e.storedCategoryMappings.entries())};await s("savedState",JSON.stringify(t))}catch(t){console.log("Error saving state to local storage",t.message)}}(e)}catch(t){return void console.log("Error saving to local storage",t.message)}}function N(e){try{b.a(e).then(e=>{const t=function(e){const t=new u.a;return e.map(e=>{let a;a=""!==e["Beguenstigter/Zahlungspflichtiger"]&&""!==e["Kontonummer/IBAN"]?e["Beguenstigter/Zahlungspflichtiger"]+"%"+e["Kontonummer/IBAN"]:e.Buchungstext;const n=t.guid(),r=i.a.utc(e.Buchungstag,"DD.MM.YY"),s=e.Betrag.replace(/,/g,".");return{...e,id:n,amount:parseFloat(s).toFixed(2),referenceString:a,bookingDate:r.toDate(),category:"Undefined",isSaving:!1}}).sort((e,t)=>e.bookingDate.valueOf()-t.bookingDate.valueOf())}(e),a=(n=o.storedCategoryMappings,t.map(e=>n.get(e.referenceString)?{...e,category:n.get(e.referenceString)}:{...e,category:"Undefined"}));var n;h({...o,transactions:a}),W(a)})}catch(t){console.log("Transaction import failed"+t.message)}}function C(){try{h({...o,transactions:[],currentBalance:"",otherSavingsBalance:"",savingGoal:"",storedCategoryMappings:new Map}),J(),y(null)}catch(e){console.log("Error clearing transactions",e.message)}}function S(e){try{const t=o.transactions.filter(t=>t.id!==e);h({...o,transactions:t})}catch(t){console.log("Error deleting transaction",t.message)}}function B(){try{const e="data:text/json,"+encodeURIComponent(JSON.stringify({mapping:Array.from(L(o.transactions).entries()),savingsTransfers:G(o.transactions)})),t="data "+(new Date).toLocaleString()+".json",a=c.current;a.href=e,a.download=t,a.click()}catch(e){console.log("Error generating category download file: ",e.message)}}function T(e){const t=new FileReader;t.onload=e=>{const a=JSON.parse(t.result);!function(t,a){if(t)try{var n;const e=null===(n=o.transactions)||void 0===n?void 0:n.map(e=>t.get(e.referenceString)?{...e,category:t.get(e.referenceString)}:e);if(!e)throw new Error("transactions were undefined");{const t=e.map(e=>{const t=e.bookingDate,n=e.amount,r=JSON.stringify(e.referenceString+"-"+t+"-"+n);return!0===a.get(r)?{...e,isSaving:!0}:e});h({...o,transactions:t}),W(t)}}catch(e){return void console.log("Error applying category mappings",e.message)}else console.log("no category map found!")}(new Map(a.mapping),new Map(a.savingsTransfers))};try{t.readAsText(e)}catch(a){console.log("Error reading file: ",a.message)}}function A(e){h({...o,currentBalance:e})}function w(e){h({...o,otherSavingsBalance:e})}function M(e){h({...o,savingGoal:e})}function k(e){h({...o,interestRate:e})}function D(){const e={...g,transactionDisplayLimit:g.transactionDisplayLimit+50};p(e)}function x(e){const t={...g,filterByCategory:e};p(t)}function O(e){const t={...g,filterClassified:e,filterByCategory:""};p(t)}function R(e){const t={...g,filterByTransactionType:e};p(t)}function F(e){const t={...g,filterBySavingsTransfer:e};p(t)}function j(e,t){const a=o.transactions.map(a=>a.id===e?{...a,isSaving:t}:a);h({...o,transactions:a})}function P(e,t){var a;const n=null===(a=o.transactions)||void 0===a?void 0:a.find(t=>t.id===e);if(n){const e=o.transactions.map(e=>e.referenceString===n.referenceString?{...e,category:t}:e),a=L(e);h({...o,transactions:e,storedCategoryMappings:a}),J(),W(e)}}function J(){const e={...g,transactionDisplayLimit:50,filterByCategory:""};p(e)}function Z(e){const t={...o,sortBy:e};l(t)}function W(e){const t=function(e){const t=function(e){return e.map(e=>({id:e.id,transactionType:e.Buchungstext,words:U(e["Beguenstigter/Zahlungspflichtiger"]),category:e.category}))}(e.filter(e=>"Undefined"!==e.category)),a=function(e){return e.reduce((e,t)=>e.includes(t.category)?e:e.concat([t.category]),[])}(t),n=function(e){const t=e.length,a=e.reduce((e,t)=>{if(e.has(t.category)){const a=e.get(t.category)+1;return e.set(t.category,a),e}return e.set(t.category,1),e},new Map);return new Map(Array.from(a).map(e=>[e[0],e[1]/t]))}(t),r=function(e){const t=(e,t)=>{const a=e.find(e=>e.word===t);if(a){const t=a.count++;return a.count=t,e}return e.concat([{word:t,count:1}])};return e.reduce((e,a)=>a.words.reduce(t,e),[])}(t),s=function(e,t,a){const n=((e,t,a)=>{const n=new Map;return t.forEach(t=>{let r=0;a.forEach(a=>{e.filter(e=>e.category===a&&e.words.includes(t.word)).length>0&&r++}),n.set(t.word,r)}),n})(e,t,a),r=new Map;return a.forEach(a=>{r.set(a,new Map);const s=e.filter(e=>e.category===a),c=s.length;t.forEach(e=>{const t=(s.filter(t=>t.words.includes(e.word)).length+.01)/c*(1/n.get(e.word));r.get(a).set(e.word,t)})}),r}(t,r,a),c=function(e){return e.reduce((e,t)=>e.includes(t.transactionType)?e:e.concat([t.transactionType]),[])}(t),o=function(e,t,a){const n=new Map;return a.forEach(a=>{n.set(a,new Map);const r=e.filter(e=>e.category===a),s=r.length;t.forEach(e=>{const t=(1+r.filter(t=>t.transactionType===e).length)/s;n.get(a).set(e,t)})}),n}(t,c,a);return e=>{if(e&&e.words){return a.map(t=>{const a=n.get(t),r=function e(a,n){if(0===a.length)return 0;if(1===a.length)return s.get(t).get(a[0])?n*s.get(t).get(a[0]):n;if(s.get(t).get(a[0])){const r=n*s.get(t).get(a[0]);return e(a.slice(1),r)}return e(a.slice(1),n)}(e.words,1);const c=o.get(t).get(e.transactionType);return{category:t,probability:a*r*c}}).sort((e,t)=>t.probability-e.probability).slice(0,1)}return{}}}(e);t&&"function"===typeof t&&y(()=>t)}function Y(e){const t=o.transactions.find(t=>t.id===e),a={id:t.id,words:U(t["Beguenstigter/Zahlungspflichtiger"]),category:t.category,transactionType:t.Buchungstext};if(a){if("function"===typeof f){return f(a)}return{}}return{}}};c.a.render(r.a.createElement(P,null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.ee284b1b.chunk.js.map