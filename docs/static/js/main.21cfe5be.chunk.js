(this.webpackJsonpsaving_analyst=this.webpackJsonpsaving_analyst||[]).push([[0],{34:function(e,t,a){e.exports=a(45)},45:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(21),s=a.n(c),o=a(1),i=a(4),l=a.n(i),u=a(11),m=a.n(u);var d=function(e){const t=Object(n.useRef)(null),a=new m.a;return r.a.createElement("div",{className:"transaction-list-controls-container"},r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.clearTransactions())},"Clear transactions"),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.generateCategoryMapping())},"Export transaction categories"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;a&&a.length>0&&e.importCategoryMappings(a[0])}(t),ref:t,type:"file",accept:".json"}),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:e=>(e.preventDefault(),void t.current.click())},"Import transaction categories")),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Show only uncategorised"),r.a.createElement("input",{type:"checkbox",checked:e.filterClassified,onChange:t=>{return a=t,void e.setFilterClassified(a.target.checked);var a}})),e.filterClassified?null:r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by category"),r.a.createElement("select",{value:e.filterByCategory,onChange:t=>{return a=t,void e.setCategoryFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),e.categoryList.map(e=>r.a.createElement("option",{key:a.string({length:16}),value:e},e)))),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by transaction type"),r.a.createElement("select",{value:e.filterByTransactionType,onChange:t=>{return a=t,void e.setTransactionTypeFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),r.a.createElement("option",{value:"Expenditure"},"Expenditure"),r.a.createElement("option",{value:"Income"},"Income"))),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by savings transfer"),r.a.createElement("input",{type:"checkbox",checked:e.filterBySavingsTransfer,onChange:t=>{return a=t,void e.setSavingsTransferFilter(a.target.checked);var a}})))))};var g=function(e){const[t,a]=Object(n.useState)(!1),[c,s]=Object(n.useState)("");if(t){const t=e.getPrediction(e.transaction.id);return r.a.createElement("div",{className:"category-editor"},0===c.length&&e.categoryList.length>0?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Select a category"),r.a.createElement("select",{value:e.category,onChange:t=>{return a=t,e.updateCategoryForMatchingItems(e.transaction.id,a.target.value),void i();var a}},r.a.createElement("option",{value:"Undefined"},"None"),e.categoryList.map(t=>r.a.createElement("option",{key:t+" "+e.transaction.id,value:t},t)))):null,r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Create a new category"),r.a.createElement("input",{value:c,onChange:e=>{s(e.target.value)},type:"text",placeholder:"Enter category name"})),c.length>0?r.a.createElement("button",{onClick:t=>(e.updateCategoryForMatchingItems(e.transaction.id,c),void i()),className:"pure-button pure-button-primary"},"Save category"):null,t&&t[0]?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Suggestion: ",t[0].category),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:()=>{return a=t[0].category,e.updateCategoryForMatchingItems(e.transaction.id,a),void i();var a}},"Confirm")):null,r.a.createElement("div",{className:"category-editor-button-spacer"}),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void i()),className:"pure-button"},"Cancel"))}return r.a.createElement("div",{className:"category-editor"},"Undefined"!==e.category?r.a.createElement("div",{className:"category-editor"},r.a.createElement("div",{className:"category-name"},e.category),r.a.createElement("button",{onClick:e=>o(!0,e),className:"pure-button"},"Edit category")):r.a.createElement("div",{className:"category-editor"},r.a.createElement("button",{onClick:e=>o(!0,e),className:"pure-button pure-button-primary"},"Add category")));function o(e,t){a(e)}function i(){a(!1),s("")}};var p=function(e){const[t,a]=Object(n.useState)(!1);return r.a.createElement("div",{className:"delete-control"},t?r.a.createElement("div",{className:"confirm-delete-container"},r.a.createElement("p",null,r.a.createElement("b",null,"Delete?")),r.a.createElement("button",{onClick:t=>(t.preventDefault(),e.deleteTransaction(e.transactionId),void a(!1)),className:"pure-button pure-button-primary"},"Yes"),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void a(!1)),className:"pure-button"},"No")):r.a.createElement("i",{onClick:e=>{a(!0)},className:"fas fa-times delete-icon"}))};var f=function(e){return r.a.createElement("div",{className:"transaction-row"},r.a.createElement(p,{deleteTransaction:e.deleteTransaction,transactionId:e.transaction.id,stateOwner:e.stateOwner}),r.a.createElement("div",{className:"transaction-data-container"},r.a.createElement("div",{className:"transaction-data-head"},r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Counterparty")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Beguenstigter/Zahlungspflichtiger"])),r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Amount")),r.a.createElement("div",{className:e.transaction.amount>=0?"transaction-text":"transaction-text negative"},e.transaction.Waehrung,": ",e.transaction.amount))),r.a.createElement("div",{className:"transaction-data-body"},r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Date")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstag)),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"IBAN")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Kontonummer/IBAN"])),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Transaction type")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstext)),r.a.createElement("div",{className:"transaction-data-body-item"},e.transaction.amount<0?r.a.createElement("div",null,r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Savings")),r.a.createElement("div",{className:"transaction-text"},r.a.createElement("input",{type:"checkbox",checked:e.transaction.isSaving,onChange:t=>function(t,a){e.updateTransactionIsSaving(a,t.target.checked)}(t,e.transaction.id)}))):null))),r.a.createElement("div",{className:"transaction-category-container"},r.a.createElement(g,{updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,transaction:e.transaction,category:e.transaction.category,categoryList:e.categoryList,getPrediction:e.getPrediction})))};var y=function(e){return r.a.createElement("div",{className:"pure-menu pure-menu-horizontal"},r.a.createElement("ul",{className:"pure-menu-list"},r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"DATE_ASC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_ASC"):e.setSortBy("DATE_DESC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-up"})));case"DATE_DESC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_DESC"):e.setSortBy("DATE_ASC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})));default:return r.a.createElement("div",{onClick:()=>("DATE_ASC"!==e.sortBy&&e.sortBy,e.setSortBy("DATE_DESC")),className:"pure-menu-link"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})))}}()),r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"AMT_ASC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_ASC"):e.setSortBy("AMT_DESC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-up"})));case"AMT_DESC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})));default:return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})))}}())))};var v=function(e){return r.a.createElement("div",{className:"transaction-list"},e.sortedTransactions.length>0?r.a.createElement(y,{setSortBy:e.setSortBy,sortBy:e.sortBy}):null,e.sortedTransactions.length>0?r.a.createElement("p",null,"Displaying ",e.sortedTransactions.slice(0,e.displayLimit).length," of ",e.transactionLength," total transactions"):null,e.sortedTransactions.slice(0,e.displayLimit).map(t=>r.a.createElement(f,{updateTransactionIsSaving:e.updateTransactionIsSaving,deleteTransaction:e.deleteTransaction,categoryList:e.categoryList,key:t.id,transaction:t,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,getPrediction:e.getPrediction})))};var E=function(e){const t=Object(n.useRef)(null),a=function(e){let{transactions:t}=e;return t.reduce((e,t)=>e.find(e=>e===t.category)||"Undefined"===t.category?e:e.concat([t.category]),[]).sort()}({transactions:e.transactions}),c=function(e){let{transactions:t,filterClassified:a,filterByCategory:n,filterByTransactionType:r,filterBySavingsTransfer:c}=e;const s=a?t.filter(e=>"Undefined"===e.category):t,o=""!==n?s.filter(e=>e.category===n):s,i=""!==r?o.filter(e=>"Income"===r?e.amount>=0:"Expenditure"===r?e.amount<0:e):o;return c?i.filter(e=>e.isSaving):i}({transactions:e.transactions,filterClassified:e.filterClassified,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType,filterBySavingsTransfer:e.filterBySavingsTransfer}),s=function(t){let{sortBy:a,transactions:n}=t;return n.concat([]).sort((t,a)=>{const n=l()(t.bookingDate),r=l()(a.bookingDate);switch(e.sortBy){case"DATE_ASC":return n.isBefore(r)?-1:r.isBefore(n)?1:0;case"DATE_DESC":return r.isBefore(n)?-1:n.isBefore(r)?1:0;case"AMT_ASC":return t.amount-a.amount;case"AMT_DESC":return a.amount-t.amount;default:return l()(a.bookingDate).utc()}})}({sortBy:e.sortBy,transactions:c});return r.a.createElement("div",{className:"transactions-container"},r.a.createElement("h2",null,"Transactions"),e.transactions.length>0?r.a.createElement(d,{categoryList:a,filterClassified:e.filterClassified,setCategoryFilter:e.setCategoryFilter,setTransactionTypeFilter:e.setTransactionTypeFilter,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType,clearTransactions:e.clearTransactions,generateCategoryMapping:e.generateCategoryMapping,importCategoryMappings:e.importCategoryMappings,setFilterClassified:e.setFilterClassified,setSavingsTransferFilter:e.setSavingsTransferFilter,filterBySavingsTransfer:e.filterBySavingsTransfer}):r.a.createElement("div",null,r.a.createElement("p",null,"Import your transactions"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;if(a&&a.length>0){const t=window.URL.createObjectURL(a[0]);e.importTransactions(t)}}(t),ref:t,type:"file",accept:".csv"}),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:e=>(e.preventDefault(),void t.current.click())},"Click to import")),r.a.createElement(v,{sortedTransactions:s,setSortBy:e.setSortBy,sortBy:e.sortBy,displayLimit:e.displayLimit,transactionLength:e.transactions.length,deleteTransaction:e.deleteTransaction,updateTransactionIsSaving:e.updateTransactionIsSaving,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,categoryList:a,getPrediction:e.getPrediction}),s.length>e.displayLimit?r.a.createElement("div",{className:"more-button-container"},r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:t=>(t.preventDefault(),void e.showMoreTransactions())},"Show more")):null)};var b=function(e){return r.a.createElement("div",{className:"management-panel-menu-bar"},r.a.createElement("div",{onClick:e=>t("Transactions",e),className:"Transactions"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Transactions"),r.a.createElement("i",{className:"far fa-list-alt fa-1x"})),r.a.createElement("div",{onClick:e=>t("Reports",e),className:"Reports"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Reports"),r.a.createElement("i",{className:"far fa-chart-bar fa-1x"})));function t(t,a){e.setRoute(t)}},h=a(23),N=a(3),C=a.n(N);var S=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),c=[{label:"Income",data:e.data.map(e=>e.income),backgroundColor:"#000000"},{label:"Expenditure",data:e.data.map(e=>e.expenditure),backgroundColor:"#ff0000"},{label:"Net savings",data:e.data.map(e=>e.total),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],s=n.getContext("2d"),o=new C.a(s,{type:"bar",data:{labels:r,datasets:c},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=o}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Income versus Expenditure by Month"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))};var B=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),c=[{label:"Cumulative savings",data:e.data.map(e=>e.savedTotal),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],s=n.getContext("2d"),o=new C.a(s,{type:"bar",data:{labels:r,datasets:c},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=o}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Cumulative Savings"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))},T=a(5);var O=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,c=T("mpn65",50),s=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+c[t%50]})),o=n.getContext("2d"),i=new C.a(o,{type:"bar",data:{labels:r,datasets:s},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Monthly expenditure by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))},j=a(22),A=a.n(j);var w=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=function(e,t,a,n){const r=12*function(e){const t=e.reduce((e,t)=>{let a;return e.length>0?(a=e[e.length-1]+t.total,e.concat([a])):e.concat([t.total])},[0]).map((e,t)=>[t,e]);return A.a.linear(t)}(e).equation[0];return function(e,t,a,n,r){return function e(t,a,n,r,c,s,o,i){if(o===r||t>c)return i;{const l=t+n,u=Math.round(a+a*s+n),m=o+1,d=i.concat({year:m,balance:l,balanceWithInterest:u});return e(l,u,n,r,c,s,m,d)}}(e,e,t,a,n,0===r?0:r/100,0,[{year:0,balance:e,balanceWithInterest:e}])}(t,r,50,a,n)}(e.data,e.currentBalance,e.savingGoal,e.interestRate),r=t.current,c=n.map(e=>"Year "+e.year),s=e.savingGoal;e.savingGoal&&function(e,t,a,n,r,c){const s=[{label:"Projected savings",data:e.map(e=>e.balance),backgroundColor:"#000000",borderColor:"#000000",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:"With ".concat(c,"% interest"),data:e.map(e=>e.balanceWithInterest),backgroundColor:"#D3D3D3",borderColor:"#D3D3D3",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:"Savings goal",data:e.map(e=>n),borderColor:"#ff0000",backgroundColor:"#ff0000",type:"line",fill:!1,pointRadius:0}],o=t.getContext("2d"),i=new C.a(o,{type:"bar",data:{labels:a,datasets:s},options:{scales:{yAxes:[{ticks:{beginAtZero:!0,max:Math.round(1.1*parseFloat(n))}}]},maintainAspectRatio:!1,responsive:!0,animation:!1}});r.current=i}(n,r,c,s,a,e.interestRate)}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Savings Projection"),r.a.createElement("div",{className:"chart-container"},e.savingGoal?r.a.createElement("canvas",{ref:t}):r.a.createElement("div",null,"You need to provide a saving goal")))};var M=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,c=T("mpn65",50),s=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+c[t%50]})),o=n.getContext("2d"),i=new C.a(o,{type:"bar",data:{labels:r,datasets:s},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Monthly income by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};var k=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e[0]),c=T("mpn65",50),s={label:"Overall expenditure",data:e.data.map(e=>e[1]),backgroundColor:c.map(e=>"#"+e)},o=n.getContext("2d"),i=new C.a(o,{type:"doughnut",data:{labels:r,datasets:[s]}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Overall expenditure by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};var D=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e[0]),c=T("mpn65",50),s={label:"Overall income",data:e.data.map(e=>e[1]),backgroundColor:c.map(e=>"#"+e)},o=n.getContext("2d"),i=new C.a(o,{type:"doughnut",data:{labels:r,datasets:[s]}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Overall income by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};function x(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}function R(e){const t=e.map(e=>[e,0]);return new Map(t)}function F(e,t){const a=R(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount<0&&!t.isSaving){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}function I(e,t){const a=R(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount>0){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}var _=function(e){const t=function(){const t=isNaN(parseFloat(e.currentBalance))?0:parseFloat(e.currentBalance),a=isNaN(parseFloat(e.otherSavingsBalance))?0:parseFloat(e.otherSavingsBalance);return t+a}(),a=isNaN(parseFloat(e.savingGoal))?0:parseFloat(e.savingGoal),c=isNaN(parseFloat(e.interestRate))?0:parseFloat(e.interestRate),s=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>{const a=l()(t.bookingDate).month(),n=l()(t.bookingDate).year(),r=parseFloat(t.amount),c=t.isSaving,s=c?x(0-r,2):0;let i;if(e.get(n)){const l=e.get(n);if(l.get(a)){const e=l.get(a),n=e.income,u=e.expenditure,m=e.total,d=e.transactions.concat([t]);if(c){const t=e.transferred;i=Object(o.a)(Object(o.a)({},e),{},{transferred:x(t+s,2),transactions:d})}else i=r>=0?Object(o.a)(Object(o.a)({},e),{},{income:x(n+r,2),total:x(m+r,2),transactions:d}):Object(o.a)(Object(o.a)({},e),{},{expenditure:x(u+r,2),total:x(m+r,2),transactions:d});l.set(a,i)}else i=c?{year:n,month:a,income:0,expenditure:0,total:0,transactions:[t],transferred:s}:r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t],transferred:0}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t],transferred:0},e.get(n).set(a,i)}else i=c?{year:n,month:a,income:0,expenditure:0,total:0,transactions:[t],transferred:s}:r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t],transferred:0}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t],transferred:0},e.set(n,new Map),e.get(n).set(a,i);return e},new Map),[e.transactions]),i=Array.prototype.concat.apply([],Array.from(s.values()).map(e=>Array.from(e.values()))),u=Object(n.useMemo)(()=>function(e,t,a){const n=e.reduce((e,t,a)=>e+t.total,0).toFixed(2),r=e.reduce((e,t,a)=>e+t.transferred,0),c=e.length,s=e.length>0?(n/c).toFixed(2):0,o=a&&t&&a>0?((t+r)/a*100).toFixed(1):0;return{totalSaving:n,averageSaving:s,percentSaved:o,totalTransferred:r}}(i,t,a),[i,t,a]),m=Object(n.useMemo)(()=>function(e,t){const a=e.reduce((e,t)=>e+t.total,0),n=e.reduce((e,t)=>e+t.transferred,0),r=x(t-a+n,2);return e.reduce((e,t,a)=>{if(0===e.length)return e.concat([{year:t.year,month:t.month,savedTotal:x(t.total+r,2)}]);{const a=e[e.length-1].savedTotal;return e.concat([{year:t.year,month:t.month,savedTotal:x(a+t.total,2)}])}},[])}(i,t),[i,t]),d=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>e.find(e=>e===t.category)?e:e.concat([t.category]),[]).sort(),[e.transactions]),g=Object(n.useMemo)(()=>function(e,t){return Array.from(F(e,t).entries()).sort((e,t)=>e[1]-t[1])}(e.transactions,d),[e.transactions,d]),p=Object(n.useMemo)(()=>function(e,t){return Array.from(I(e,t).entries()).filter(e=>e[1]>0).sort((e,t)=>t[1]-e[1])}(e.transactions,d),[e.transactions,d]),f=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>F(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>0-t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(i,d),[i,d]),y=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>I(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(i,d),[i,d]);return r.a.createElement("div",{className:"reports-container"},r.a.createElement("h2",null,"Reports"),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Current balance (EUR)"),r.a.createElement("input",{type:"number",value:e.currentBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setCurrentBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Other savings (EUR)"),r.a.createElement("input",{type:"number",value:e.otherSavingsBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setOtherSavingsBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Saving goal (EUR)"),r.a.createElement("input",{type:"number",value:e.savingGoal,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setSavingGoal(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Interest rate (%)"),r.a.createElement("div",{className:"interest-rate-slider"},r.a.createElement("input",{type:"range",min:"0",max:"100",step:"1",value:e.interestRate,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setInterestRate(t.target.value)}(t)}),r.a.createElement("div",{className:"rate-display"},e.interestRate,"%"))))),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Saving summary"),r.a.createElement("div",{className:"stat-container"},r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",u.totalSaving),r.a.createElement("div",{className:"stat-text"},"Saved during period")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",u.averageSaving),r.a.createElement("div",{className:"stat-text"},"Average monthly saving")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},u.percentSaved," %"),r.a.createElement("div",{className:"stat-text"},"Towards savings target")))),r.a.createElement(S,{data:i}),r.a.createElement(B,{data:m}),r.a.createElement(w,{data:i,currentBalance:t+u.totalTransferred,savingGoal:a,interestRate:c}),r.a.createElement(k,{data:g}),r.a.createElement(O,{data:f}),r.a.createElement(D,{data:p}),r.a.createElement(M,{data:y}))},L=a(24);function G(e){return e.reduce((e,t)=>(e.get(t.referenceString)||"Undefined"===t.category||e.set(t.referenceString,t.category),e),new Map)}function U(e){return e.filter(e=>e.isSaving).map(e=>{const t=e.bookingDate,a=e.amount;return[JSON.stringify(e.referenceString+"-"+t+"-"+a),e.isSaving]})}function P(e){return e.replace(/\/\//g," ").replace(/\/\//g," ").replace(/%/g," ").replace(/\./g," ").split(" ").filter(e=>""!==e)}var J=function(e){const t=async()=>await Object(L.a)("saving_analyst",1,{upgrade(e){e.createObjectStore("transactions")}}),a=async e=>(await t()).get("transactions",e),c=async(e,a)=>(await t()).put("transactions",a,e),s=Object(n.useRef)(null),[i,u]=Object(n.useState)({transactions:[],currentBalance:"",otherSavingsBalance:"0",savingGoal:"",interestRate:"0",storedCategoryMappings:new Map}),[d,g]=Object(n.useState)("Transactions"),[p,f]=Object(n.useState)({transactionDisplayLimit:50,filterClassified:!1,filterByCategory:"",filterByTransactionType:"",sortBy:"DATE_DESC",filterBySavingsTransfer:!1}),[y,v]=Object(n.useState)(null);return Object(n.useEffect)(()=>{try{!async function(){const e=await async function(){try{console.log("Here");const e=await a("savedState"),t=e?JSON.parse(e):{};return Object(o.a)(Object(o.a)({},i),{},{transactions:e?t.transactions:[],currentBalance:e?t.currentBalance:"",otherSavingsBalance:e?t.otherSavingsBalance:"",savingGoal:e?t.savingGoal:"",interestRate:e?t.interestRate:"0",storedCategoryMappings:e?new Map(t.storedCategoryMappings):new Map})}catch(e){console.log("Error retrieving from local storage",e.message)}}();u(e),Y(e.transactions)}()}catch(e){console.log("Error applying state from local storage to running application ",e.message)}},[]),r.a.createElement("div",{className:"app-page app-content"},r.a.createElement("a",{className:"hidden-input",href:"hidden",ref:s},"Hidden data download link"),r.a.createElement("div",{className:"app-header"},r.a.createElement("div",{className:"app-logo-container"},"Saving Analyst")),r.a.createElement("div",{className:"app-main-content"},r.a.createElement("div",{className:"management-panel"},r.a.createElement(b,{setRoute:function(e){g(e)},route:d}),r.a.createElement("div",{className:"management-panel-content"},function(){switch(d){case"Transactions":return r.a.createElement(E,{displayLimit:p.transactionDisplayLimit,transactions:i.transactions,filterByCategory:p.filterByCategory,filterClassified:p.filterClassified,filterByTransactionType:p.filterByTransactionType,filterBySavingsTransfer:p.filterBySavingsTransfer,currentBalance:i.currentBalance,otherSavingsBalance:i.otherSavingsBalance,savingGoal:i.savingGoal,sortBy:i.sortBy,setSortBy:W,importTransactions:C,importCategoryMappings:O,clearTransactions:S,generateCategoryMapping:T,showMoreTransactions:k,setFilterClassified:x,setCategoryFilter:D,setTransactionTypeFilter:R,deleteTransaction:B,updateCategoryForMatchingItems:J,updateTransactionIsSaving:I,getPrediction:K,setSavingsTransferFilter:F});case"Reports":return r.a.createElement(_,{state:i,transactions:i.transactions,currentBalance:i.currentBalance,otherSavingsBalance:i.otherSavingsBalance,interestRate:i.interestRate,savingGoal:i.savingGoal,setSavingGoal:w,setInterestRate:M,setCurrentBalance:j,setOtherSavingsBalance:A});default:return r.a.createElement("div",null,"Something went wrong!")}}()))));function N(e){try{u(e)}catch(t){return void console.log("Error saving state",t.message)}try{!async function(e){try{const t={transactions:e.transactions,currentBalance:e.currentBalance,otherSavingsBalance:e.otherSavingsBalance,savingGoal:e.savingGoal,interestRate:e.interestRate,storedCategoryMappings:Array.from(e.storedCategoryMappings.entries())};await c("savedState",JSON.stringify(t))}catch(t){console.log("Error saving state to local storage",t.message)}}(e)}catch(t){return void console.log("Error saving to local storage",t.message)}}function C(e){try{h.a(e).then(e=>{const t=function(e){const t=new m.a;return e.map(e=>{let a;a=""!==e["Beguenstigter/Zahlungspflichtiger"]&&""!==e["Kontonummer/IBAN"]?e["Beguenstigter/Zahlungspflichtiger"]+"%"+e["Kontonummer/IBAN"]:e.Buchungstext;const n=t.guid(),r=l.a.utc(e.Buchungstag,"DD.MM.YY"),c=e.Betrag.replace(/,/g,".");return Object(o.a)(Object(o.a)({},e),{},{id:n,amount:parseFloat(c).toFixed(2),referenceString:a,bookingDate:r.toDate(),category:"Undefined",isSaving:!1})}).sort((e,t)=>e.bookingDate.valueOf()-t.bookingDate.valueOf())}(e),a=(n=i.storedCategoryMappings,t.map(e=>n.get(e.referenceString)?Object(o.a)(Object(o.a)({},e),{},{category:n.get(e.referenceString)}):Object(o.a)(Object(o.a)({},e),{},{category:"Undefined"})));var n;N(Object(o.a)(Object(o.a)({},i),{},{transactions:a})),Y(a)})}catch(t){console.log("Transaction import failed"+t.message)}}function S(){try{N(Object(o.a)(Object(o.a)({},i),{},{transactions:[],currentBalance:"",otherSavingsBalance:"",savingGoal:"",storedCategoryMappings:new Map})),Z(),v(null)}catch(e){console.log("Error clearing transactions",e.message)}}function B(e){try{const t=i.transactions.filter(t=>t.id!==e);N(Object(o.a)(Object(o.a)({},i),{},{transactions:t}))}catch(t){console.log("Error deleting transaction",t.message)}}function T(){try{const e="data:text/json,"+encodeURIComponent(JSON.stringify({mapping:Array.from(G(i.transactions).entries()),savingsTransfers:U(i.transactions)})),t="data "+(new Date).toLocaleString()+".json",a=s.current;a.href=e,a.download=t,a.click()}catch(e){console.log("Error generating category download file: ",e.message)}}function O(e){const t=new FileReader;t.onload=e=>{const a=JSON.parse(t.result);!function(t,a){if(t)try{var n;const e=null===(n=i.transactions)||void 0===n?void 0:n.map(e=>t.get(e.referenceString)?Object(o.a)(Object(o.a)({},e),{},{category:t.get(e.referenceString)}):e);if(!e)throw new Error("transactions were undefined");{const t=e.map(e=>{const t=e.bookingDate,n=e.amount,r=JSON.stringify(e.referenceString+"-"+t+"-"+n);return!0===a.get(r)?Object(o.a)(Object(o.a)({},e),{},{isSaving:!0}):e});N(Object(o.a)(Object(o.a)({},i),{},{transactions:t})),Y(t)}}catch(e){return void console.log("Error applying category mappings",e.message)}else console.log("no category map found!")}(new Map(a.mapping),new Map(a.savingsTransfers))};try{t.readAsText(e)}catch(a){console.log("Error reading file: ",a.message)}}function j(e){N(Object(o.a)(Object(o.a)({},i),{},{currentBalance:e}))}function A(e){N(Object(o.a)(Object(o.a)({},i),{},{otherSavingsBalance:e}))}function w(e){N(Object(o.a)(Object(o.a)({},i),{},{savingGoal:e}))}function M(e){N(Object(o.a)(Object(o.a)({},i),{},{interestRate:e}))}function k(){const e=Object(o.a)(Object(o.a)({},p),{},{transactionDisplayLimit:p.transactionDisplayLimit+50});f(e)}function D(e){const t=Object(o.a)(Object(o.a)({},p),{},{filterByCategory:e});f(t)}function x(e){const t=Object(o.a)(Object(o.a)({},p),{},{filterClassified:e,filterByCategory:""});f(t)}function R(e){const t=Object(o.a)(Object(o.a)({},p),{},{filterByTransactionType:e});f(t)}function F(e){const t=Object(o.a)(Object(o.a)({},p),{},{filterBySavingsTransfer:e});f(t)}function I(e,t){const a=i.transactions.map(a=>a.id===e?Object(o.a)(Object(o.a)({},a),{},{isSaving:t}):a);N(Object(o.a)(Object(o.a)({},i),{},{transactions:a}))}function J(e,t){var a;const n=null===(a=i.transactions)||void 0===a?void 0:a.find(t=>t.id===e);if(n){const e=i.transactions.map(e=>e.referenceString===n.referenceString?Object(o.a)(Object(o.a)({},e),{},{category:t}):e),a=G(e);N(Object(o.a)(Object(o.a)({},i),{},{transactions:e,storedCategoryMappings:a})),Z(),Y(e)}}function Z(){const e=Object(o.a)(Object(o.a)({},p),{},{transactionDisplayLimit:50,filterByCategory:""});f(e)}function W(e){const t=Object(o.a)(Object(o.a)({},i),{},{sortBy:e});u(t)}function Y(e){const t=function(e){const t=function(e){return e.map(e=>({id:e.id,transactionType:e.Buchungstext,words:P(e["Beguenstigter/Zahlungspflichtiger"]),category:e.category}))}(e.filter(e=>"Undefined"!==e.category)),a=function(e){return e.reduce((e,t)=>e.includes(t.category)?e:e.concat([t.category]),[])}(t),n=function(e){const t=e.length,a=e.reduce((e,t)=>{if(e.has(t.category)){const a=e.get(t.category)+1;return e.set(t.category,a),e}return e.set(t.category,1),e},new Map);return new Map(Array.from(a).map(e=>[e[0],e[1]/t]))}(t),r=function(e){const t=(e,t)=>{const a=e.find(e=>e.word===t);if(a){const t=a.count++;return a.count=t,e}return e.concat([{word:t,count:1}])};return e.reduce((e,a)=>a.words.reduce(t,e),[])}(t),c=function(e,t,a){const n=((e,t,a)=>{const n=new Map;return t.forEach(t=>{let r=0;a.forEach(a=>{e.filter(e=>e.category===a&&e.words.includes(t.word)).length>0&&r++}),n.set(t.word,r)}),n})(e,t,a),r=new Map;return a.forEach(a=>{r.set(a,new Map);const c=e.filter(e=>e.category===a),s=c.length;t.forEach(e=>{const t=(c.filter(t=>t.words.includes(e.word)).length+.01)/s*(1/n.get(e.word));r.get(a).set(e.word,t)})}),r}(t,r,a),s=function(e){return e.reduce((e,t)=>e.includes(t.transactionType)?e:e.concat([t.transactionType]),[])}(t),o=function(e,t,a){const n=new Map;return a.forEach(a=>{n.set(a,new Map);const r=e.filter(e=>e.category===a),c=r.length;t.forEach(e=>{const t=(1+r.filter(t=>t.transactionType===e).length)/c;n.get(a).set(e,t)})}),n}(t,s,a);return e=>{if(e&&e.words){return a.map(t=>{const a=n.get(t),r=function e(a,n){if(0===a.length)return 0;if(1===a.length)return c.get(t).get(a[0])?n*c.get(t).get(a[0]):n;if(c.get(t).get(a[0])){const r=n*c.get(t).get(a[0]);return e(a.slice(1),r)}return e(a.slice(1),n)}(e.words,1);const s=o.get(t).get(e.transactionType);return{category:t,probability:a*r*s}}).sort((e,t)=>t.probability-e.probability).slice(0,1)}return{}}}(e);t&&"function"===typeof t&&v(()=>t)}function K(e){const t=i.transactions.find(t=>t.id===e),a={id:t.id,words:P(t["Beguenstigter/Zahlungspflichtiger"]),category:t.category,transactionType:t.Buchungstext};if(a){if("function"===typeof y){return y(a)}return{}}return{}}};s.a.render(r.a.createElement(J,null),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.21cfe5be.chunk.js.map