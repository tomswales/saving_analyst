(this.webpackJsonpsaving_analyst=this.webpackJsonpsaving_analyst||[]).push([[0],{29:function(e,t,a){e.exports=a(40)},40:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(21),c=a.n(s),o=a(1),i=a(5),l=a(4),u=a.n(l),m=a(11),d=a.n(m);var g=function(e){const t=Object(n.useRef)(null),a=new d.a;return r.a.createElement("div",{className:"transaction-list-controls-container"},r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.clearTransactions())},"Clear transactions"),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:t=>(t.preventDefault(),void e.generateCategoryMapping())},"Export transaction categories"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;a&&a.length>0&&e.importCategoryMappings(a[0])}(t),ref:t,type:"file",accept:".json"}),r.a.createElement("button",{className:"pure-button pure-button-primary transaction-control-button",onClick:e=>(e.preventDefault(),void t.current.click())},"Import transaction categories")),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Show only uncategorised"),r.a.createElement("input",{type:"checkbox",checked:e.filterClassified,onChange:t=>{return a=t,void e.setFilterClassified(a.target.checked);var a}})),e.filterClassified?null:r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by category"),r.a.createElement("select",{value:e.filterByCategory,onChange:t=>{return a=t,void e.setCategoryFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),e.categoryList.map(e=>r.a.createElement("option",{key:a.string({length:16}),value:e},e)))),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by transaction type"),r.a.createElement("select",{value:e.filterByTransactionType,onChange:t=>{return a=t,void e.setTransactionTypeFilter(a.target.value);var a}},r.a.createElement("option",{value:""},"None"),r.a.createElement("option",{value:"Expenditure"},"Expenditure"),r.a.createElement("option",{value:"Income"},"Income"))),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Filter by savings transfer"),r.a.createElement("input",{type:"checkbox",checked:e.filterBySavingsTransfer,onChange:t=>{return a=t,void e.setSavingsTransferFilter(a.target.checked);var a}})))))};var p=function(e){const t=Object(n.useState)(!1),a=Object(i.a)(t,2),s=a[0],c=a[1],o=Object(n.useState)(""),l=Object(i.a)(o,2),u=l[0],m=l[1];if(s){const t=e.getPrediction(e.transaction.id);return r.a.createElement("div",{className:"category-editor"},0===u.length&&e.categoryList.length>0?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Select a category"),r.a.createElement("select",{value:e.category,onChange:t=>{return a=t,e.updateCategoryForMatchingItems(e.transaction.id,a.target.value),void g();var a}},r.a.createElement("option",{value:"Undefined"},"None"),e.categoryList.map(t=>r.a.createElement("option",{key:t+" "+e.transaction.id,value:t},t)))):null,r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Create a new category"),r.a.createElement("input",{value:u,onChange:e=>{m(e.target.value)},type:"text",placeholder:"Enter category name"})),u.length>0?r.a.createElement("button",{onClick:t=>(e.updateCategoryForMatchingItems(e.transaction.id,u),void g()),className:"pure-button pure-button-primary"},"Save category"):null,t&&t[0]?r.a.createElement("div",{className:"category-editor-control pure-form"},r.a.createElement("b",null,"Suggestion: ",t[0].category),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:()=>{return a=t[0].category,e.updateCategoryForMatchingItems(e.transaction.id,a),void g();var a}},"Confirm")):null,r.a.createElement("div",{className:"category-editor-button-spacer"}),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void g()),className:"pure-button"},"Cancel"))}return r.a.createElement("div",{className:"category-editor"},"Undefined"!==e.category?r.a.createElement("div",{className:"category-editor"},r.a.createElement("div",{className:"category-name"},e.category),r.a.createElement("button",{onClick:e=>d(!0,e),className:"pure-button"},"Edit category")):r.a.createElement("div",{className:"category-editor"},r.a.createElement("button",{onClick:e=>d(!0,e),className:"pure-button pure-button-primary"},"Add category")));function d(e,t){c(e)}function g(){c(!1),m("")}};var f=function(e){const t=Object(n.useState)(!1),a=Object(i.a)(t,2),s=a[0],c=a[1];return r.a.createElement("div",{className:"delete-control"},s?r.a.createElement("div",{className:"confirm-delete-container"},r.a.createElement("p",null,r.a.createElement("b",null,"Delete?")),r.a.createElement("button",{onClick:t=>(t.preventDefault(),e.deleteTransaction(e.transactionId),void c(!1)),className:"pure-button pure-button-primary"},"Yes"),r.a.createElement("button",{onClick:e=>(e.preventDefault(),void c(!1)),className:"pure-button"},"No")):r.a.createElement("i",{onClick:e=>{c(!0)},className:"fas fa-times delete-icon"}))};var y=function(e){return r.a.createElement("div",{className:"transaction-row"},r.a.createElement(f,{deleteTransaction:e.deleteTransaction,transactionId:e.transaction.id,stateOwner:e.stateOwner}),r.a.createElement("div",{className:"transaction-data-container"},r.a.createElement("div",{className:"transaction-data-head"},r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Counterparty")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Beguenstigter/Zahlungspflichtiger"])),r.a.createElement("div",{className:"transaction-data-head-item"},r.a.createElement("div",{className:"transaction-text"},r.a.createElement("b",null,"Amount")),r.a.createElement("div",{className:e.transaction.amount>=0?"transaction-text":"transaction-text negative"},e.transaction.Waehrung,": ",e.transaction.amount))),r.a.createElement("div",{className:"transaction-data-body"},r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Date")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstag)),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"IBAN")),r.a.createElement("div",{className:"transaction-text"},e.transaction["Kontonummer/IBAN"])),r.a.createElement("div",{className:"transaction-data-body-item"},r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Transaction type")),r.a.createElement("div",{className:"transaction-text"},e.transaction.Buchungstext)),r.a.createElement("div",{className:"transaction-data-body-item"},e.transaction.amount<0?r.a.createElement("div",null,r.a.createElement("div",{className:"transaction-data-body-label"},r.a.createElement("b",null,"Savings")),r.a.createElement("div",{className:"transaction-text"},r.a.createElement("input",{type:"checkbox",checked:e.transaction.isSaving,onChange:t=>function(t,a){e.updateTransactionIsSaving(a,t.target.checked)}(t,e.transaction.id)}))):null))),r.a.createElement("div",{className:"transaction-category-container"},r.a.createElement(p,{updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,transaction:e.transaction,category:e.transaction.category,categoryList:e.categoryList,getPrediction:e.getPrediction})))};var v=function(e){return r.a.createElement("div",{className:"pure-menu pure-menu-horizontal"},r.a.createElement("ul",{className:"pure-menu-list"},r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"DATE_ASC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_ASC"):e.setSortBy("DATE_DESC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-up"})));case"DATE_DESC":return r.a.createElement("div",{onClick:()=>"DATE_ASC"!==e.sortBy&&"DATE_DESC"!==e.sortBy?e.setSortBy("DATE_DESC"):e.setSortBy("DATE_ASC"),className:"pure-menu-link pure-menu-selected"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})));default:return r.a.createElement("div",{onClick:()=>("DATE_ASC"!==e.sortBy&&e.sortBy,e.setSortBy("DATE_DESC")),className:"pure-menu-link"},"Date",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-calendar-alt"})),r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-arrow-down"})))}}()),r.a.createElement("li",{className:"pure-menu-item"},function(){switch(e.sortBy){case"AMT_ASC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_ASC"):e.setSortBy("AMT_DESC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-up"})));case"AMT_DESC":return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link pure-menu-selected"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})));default:return r.a.createElement("div",{onClick:()=>"AMT_ASC"!==e.sortBy&&"AMT_DESC"!==e.sortBy?e.setSortBy("AMT_DESC"):e.setSortBy("AMT_ASC"),className:"pure-menu-link"},"Amount",r.a.createElement("span",null," ",r.a.createElement("i",{className:"fas fa-sort-amount-down"})))}}())))};var E=function(e){return r.a.createElement("div",{className:"transaction-list"},e.sortedTransactions.length>0?r.a.createElement(v,{setSortBy:e.setSortBy,sortBy:e.sortBy}):null,e.sortedTransactions.length>0?r.a.createElement("p",null,"Displaying ",e.sortedTransactions.slice(0,e.displayLimit).length," of ",e.transactionLength," total transactions"):null,e.sortedTransactions.slice(0,e.displayLimit).map(t=>r.a.createElement(y,{updateTransactionIsSaving:e.updateTransactionIsSaving,deleteTransaction:e.deleteTransaction,categoryList:e.categoryList,key:t.id,transaction:t,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,getPrediction:e.getPrediction})))};var b=function(e){const t=Object(n.useRef)(null),a=function({transactions:e}){return e.reduce((e,t)=>e.find(e=>e===t.category)||"Undefined"===t.category?e:e.concat([t.category]),[]).sort()}({transactions:e.transactions}),s=function({transactions:e,filterClassified:t,filterByCategory:a,filterByTransactionType:n,filterBySavingsTransfer:r}){const s=t?e.filter(e=>"Undefined"===e.category):e,c=""!==a?s.filter(e=>e.category===a):s,o=""!==n?c.filter(e=>"Income"===n?e.amount>=0:"Expenditure"===n?e.amount<0:e):c;return r?o.filter(e=>e.isSaving):o}({transactions:e.transactions,filterClassified:e.filterClassified,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType,filterBySavingsTransfer:e.filterBySavingsTransfer}),c=function({sortBy:t,transactions:a}){return a.concat([]).sort((t,a)=>{const n=u()(t.bookingDate),r=u()(a.bookingDate);switch(e.sortBy){case"DATE_ASC":return n.isBefore(r)?-1:r.isBefore(n)?1:0;case"DATE_DESC":return r.isBefore(n)?-1:n.isBefore(r)?1:0;case"AMT_ASC":return t.amount-a.amount;case"AMT_DESC":return a.amount-t.amount;default:return u()(a.bookingDate).utc()}})}({sortBy:e.sortBy,transactions:s});return r.a.createElement("div",{className:"transactions-container"},r.a.createElement("h2",null,"Transactions"),e.transactions.length>0?r.a.createElement(g,{categoryList:a,filterClassified:e.filterClassified,setCategoryFilter:e.setCategoryFilter,setTransactionTypeFilter:e.setTransactionTypeFilter,filterByCategory:e.filterByCategory,filterByTransactionType:e.filterByTransactionType,clearTransactions:e.clearTransactions,generateCategoryMapping:e.generateCategoryMapping,importCategoryMappings:e.importCategoryMappings,setFilterClassified:e.setFilterClassified,setSavingsTransferFilter:e.setSavingsTransferFilter,filterBySavingsTransfer:e.filterBySavingsTransfer}):r.a.createElement("div",null,r.a.createElement("p",null,"Import your transactions"),r.a.createElement("input",{className:"hidden-input",onChange:t=>function(t){const a=t.target.files;if(a&&a.length>0){const t=window.URL.createObjectURL(a[0]);e.importTransactions(t)}}(t),ref:t,type:"file",accept:".csv"}),r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:e=>(e.preventDefault(),void t.current.click())},"Click to import")),r.a.createElement(E,{sortedTransactions:c,setSortBy:e.setSortBy,sortBy:e.sortBy,displayLimit:e.displayLimit,transactionLength:e.transactions.length,deleteTransaction:e.deleteTransaction,updateTransactionIsSaving:e.updateTransactionIsSaving,updateCategoryForMatchingItems:e.updateCategoryForMatchingItems,categoryList:a,getPrediction:e.getPrediction}),c.length>e.displayLimit?r.a.createElement("div",{className:"more-button-container"},r.a.createElement("button",{className:"pure-button pure-button-primary",onClick:t=>(t.preventDefault(),void e.showMoreTransactions())},"Show more")):null)};var h=function(e){return r.a.createElement("div",{className:"management-panel-menu-bar"},r.a.createElement("div",{onClick:e=>t("Transactions",e),className:"Transactions"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Transactions"),r.a.createElement("i",{className:"far fa-list-alt fa-1x"})),r.a.createElement("div",{onClick:e=>t("Reports",e),className:"Reports"===e.route?"management-panel-menu-item active":"management-panel-menu-item"},r.a.createElement("div",null,"Reports"),r.a.createElement("i",{className:"far fa-chart-bar fa-1x"})));function t(t,a){e.setRoute(t)}},N=a(23),C=a(3),S=a.n(C);var B=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),s=[{label:"Income",data:e.data.map(e=>e.income),backgroundColor:"#000000"},{label:"Expenditure",data:e.data.map(e=>e.expenditure),backgroundColor:"#ff0000"},{label:"Net savings",data:e.data.map(e=>e.total),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],c=n.getContext("2d"),o=new S.a(c,{type:"bar",data:{labels:r,datasets:s},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=o}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Income versus Expenditure by Month"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))};var T=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.map(e=>e.month+1+" "+e.year),s=[{label:"Cumulative savings",data:e.data.map(e=>e.savedTotal),backgroundColor:"#9b9b9b",type:"line",pointRadius:3}],c=n.getContext("2d"),o=new S.a(c,{type:"bar",data:{labels:r,datasets:s},options:{scales:{yAxes:[{ticks:{beginAtZero:!0}}]},maintainAspectRatio:!1,responsive:!0}});a.current=o}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Cumulative Savings"),r.a.createElement("div",{className:"chart-container"},r.a.createElement("canvas",{ref:t})))},O=a(12);var A=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,s=O("mpn65",50),c=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+s[t%50]})),o=n.getContext("2d"),i=new S.a(o,{type:"bar",data:{labels:r,datasets:c},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Expenditure by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))},w=a(22),D=a.n(w);var k=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=function(e,t,a,n){const r=12*function(e){const t=e.reduce((e,t)=>{let a;return e.length>0?(a=e[e.length-1]+t.total,e.concat([a])):e.concat([t.total])},[0]).map((e,t)=>[t,e]);return D.a.linear(t)}(e).equation[0];return function(e,t,a,n,r){return function e(t,a,n,r,s,c,o,i){if(o===r||t>s)return i;{const l=t+n,u=Math.round(a+a*c+n),m=o+1,d=i.concat({year:m,balance:l,balanceWithInterest:u});return e(l,u,n,r,s,c,m,d)}}(e,e,t,a,n,0===r?0:r/100,0,[{year:0,balance:e,balanceWithInterest:e}])}(t,r,50,a,n)}(e.data,e.currentBalance,e.savingGoal,e.interestRate),r=t.current,s=n.map(e=>"Year "+e.year),c=e.savingGoal;e.savingGoal&&function(e,t,a,n,r,s){const c=[{label:"Projected savings",data:e.map(e=>e.balance),backgroundColor:"#000000",borderColor:"#000000",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:"With ".concat(s,"% interest"),data:e.map(e=>e.balanceWithInterest),backgroundColor:"#D3D3D3",borderColor:"#D3D3D3",type:"line",pointRadius:3,fill:!1,lineTension:0},{label:"Savings goal",data:e.map(e=>n),borderColor:"#ff0000",backgroundColor:"#ff0000",type:"line",fill:!1,pointRadius:0}],o=t.getContext("2d"),i=new S.a(o,{type:"bar",data:{labels:a,datasets:c},options:{scales:{yAxes:[{ticks:{beginAtZero:!0,max:Math.round(1.1*parseFloat(n))}}]},maintainAspectRatio:!1,responsive:!0,animation:!1}});r.current=i}(n,r,s,c,a,e.interestRate)}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Savings Projection"),r.a.createElement("div",{className:"chart-container"},e.savingGoal?r.a.createElement("canvas",{ref:t}):r.a.createElement("div",null,"You need to provide a saving goal")))};var j=function(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(null);return Object(n.useEffect)(()=>{a.current&&a.current.destroy();const n=t.current,r=e.data.months,s=O("mpn65",50),c=e.data.datasets.map((e,t)=>({label:e.category,data:e.data,backgroundColor:"#"+s[t%50]})),o=n.getContext("2d"),i=new S.a(o,{type:"bar",data:{labels:r,datasets:c},options:{scales:{xAxes:[{stacked:!0}],yAxes:[{stacked:!0}]},maintainAspectRatio:!1,responsive:!0}});a.current=i}),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Income by category"),r.a.createElement("div",{className:"chart-container double"},r.a.createElement("canvas",{ref:t})))};function M(e,t){return Number(Math.round(e+"e"+t)+"e-"+t)}function x(e){const t=e.map(e=>[e,0]);return new Map(t)}var F=function(e){const t=function(){const t=isNaN(parseFloat(e.currentBalance))?0:parseFloat(e.currentBalance),a=isNaN(parseFloat(e.otherSavingsBalance))?0:parseFloat(e.otherSavingsBalance);return t+a}(),a=isNaN(parseFloat(e.savingGoal))?0:parseFloat(e.savingGoal),s=isNaN(parseFloat(e.interestRate))?0:parseFloat(e.interestRate),c=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>{const a=u()(t.bookingDate).month(),n=u()(t.bookingDate).year(),r=parseFloat(t.amount),s=t.isSaving,c=s?M(0-r,2):0;let i;if(e.get(n)){const l=e.get(n);if(l.get(a)){const e=l.get(a),n=e.income,u=e.expenditure,m=e.total,d=e.transactions.concat([t]);if(s){const t=e.transferred;i=Object(o.a)({},e,{transferred:M(t+c,2),transactions:d})}else i=r>=0?Object(o.a)({},e,{income:M(n+r,2),total:M(m+r,2),transactions:d}):Object(o.a)({},e,{expenditure:M(u+r,2),total:M(m+r,2),transactions:d});l.set(a,i)}else i=s?{year:n,month:a,income:0,expenditure:0,total:0,transactions:[t],transferred:c}:r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t],transferred:0}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t],transferred:0},e.get(n).set(a,i)}else i=s?{year:n,month:a,income:0,expenditure:0,total:0,transactions:[t],transferred:c}:r>=0?{year:n,month:a,income:r,expenditure:0,total:r,transactions:[t],transferred:0}:{year:n,month:a,income:0,expenditure:r,total:r,transactions:[t],transferred:0},e.set(n,new Map),e.get(n).set(a,i);return e},new Map),[e.transactions]),i=Array.prototype.concat.apply([],Array.from(c.values()).map(e=>Array.from(e.values()))),l=Object(n.useMemo)(()=>function(e,t,a){const n=e.reduce((e,t,a)=>e+t.total,0).toFixed(2),r=e.length,s=e.length>0?(n/r).toFixed(2):0,c=a&&t&&a>0?(t/a*100).toFixed(1):0;return{totalSaving:n,averageSaving:s,percentSaved:c}}(i,t,a),[i,t,a]),m=Object(n.useMemo)(()=>function(e,t){const a=e.reduce((e,t)=>e+t.total,0),n=e.reduce((e,t)=>e+t.transferred,0),r=M(t-a+n,2);return e.reduce((e,t,a)=>{if(0===e.length)return e.concat([{year:t.year,month:t.month,savedTotal:M(t.total+r,2)}]);{const a=e[e.length-1].savedTotal;return e.concat([{year:t.year,month:t.month,savedTotal:M(a+t.total,2)}])}},[])}(i,t),[i,t]),d=Object(n.useMemo)(()=>e.transactions.reduce((e,t)=>e.find(e=>e===t.category)?e:e.concat([t.category]),[]).sort(),[e.transactions]),g=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>function(e,t){const a=x(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount<0&&!t.isSaving){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>0-t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(i,d),[i,d]),p=Object(n.useMemo)(()=>function(e,t){const a=function(e,t){return e.map(e=>function(e,t){const a=x(t);return e.reduce((e,t)=>{if(e.has(t.category)){if(t.amount>0){const a=parseFloat(e.get(t.category))+parseFloat(t.amount);e.set(t.category,a)}return e}return e},a)}(e.transactions,t))}(e,t),n=(e,t)=>e+t,r=t.map(e=>{const t=a.map(t=>t.get(e));return{category:e,data:t,total:t.reduce(n,0),noExpenditures:t.every(e=>0===e)}}).filter(e=>!e.noExpenditures);return{months:e.map(e=>e.month+1+" "+e.year),datasets:r.sort((e,t)=>t.total-e.total)}}(i,d),[i,d]);return r.a.createElement("div",{className:"reports-container"},r.a.createElement("h2",null,"Reports"),r.a.createElement("div",{className:"transaction-list-controls"},r.a.createElement("form",{onSubmit:e=>{e.preventDefault()},className:"pure-form pure-form-stacked"},r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Current balance (EUR)"),r.a.createElement("input",{type:"number",value:e.currentBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setCurrentBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Other savings (EUR)"),r.a.createElement("input",{type:"number",value:e.otherSavingsBalance,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setOtherSavingsBalance(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Saving goal (EUR)"),r.a.createElement("input",{type:"number",value:e.savingGoal,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setSavingGoal(t.target.value)}(t)})),r.a.createElement("div",{className:"filter-control"},r.a.createElement("label",{htmlFor:""},"Interest rate (%)"),r.a.createElement("div",{className:"interest-rate-slider"},r.a.createElement("input",{type:"range",min:"0",max:"100",step:"1",value:e.interestRate,onChange:t=>function(t){t.preventDefault();const a=Number(t.target.value);isNaN(a)&&""!==a||e.setInterestRate(t.target.value)}(t)}),r.a.createElement("div",{className:"rate-display"},e.interestRate,"%"))))),r.a.createElement("div",{className:"chart-panel"},r.a.createElement("h4",null,"Saving summary"),r.a.createElement("div",{className:"stat-container"},r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",l.totalSaving),r.a.createElement("div",{className:"stat-text"},"Saved during period")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},"EUR ",l.averageSaving),r.a.createElement("div",{className:"stat-text"},"Average monthly saving")),r.a.createElement("div",{className:"stat-section"},r.a.createElement("div",{className:"stat-number"},l.percentSaved," %"),r.a.createElement("div",{className:"stat-text"},"Towards savings target")))),r.a.createElement(B,{data:i}),r.a.createElement(T,{data:m}),r.a.createElement(k,{data:i,currentBalance:t,savingGoal:a,interestRate:s}),r.a.createElement(A,{data:g}),r.a.createElement(j,{data:p}))};function R(e){return e.reduce((e,t)=>(e.get(t.referenceString)||"Undefined"===t.category||e.set(t.referenceString,t.category),e),new Map)}function I(e){return e.filter(e=>e.isSaving).map(e=>{const t=e.bookingDate,a=e.amount;return[JSON.stringify(e.referenceString+"-"+t+"-"+a),e.isSaving]})}function _(e){return e.replace(/\/\//g," ").replace(/\/\//g," ").replace(/%/g," ").replace(/\./g," ").split(" ").filter(e=>""!==e)}var L=function(e){const t=Object(n.useRef)(null),a=Object(n.useState)({transactions:[],currentBalance:"",otherSavingsBalance:"0",savingGoal:"",interestRate:"0",storedCategoryMappings:new Map}),s=Object(i.a)(a,2),c=s[0],l=s[1],m=Object(n.useState)("Transactions"),g=Object(i.a)(m,2),p=g[0],f=g[1],y=Object(n.useState)({transactionDisplayLimit:50,filterClassified:!1,filterByCategory:"",filterByTransactionType:"",sortBy:"DATE_DESC",filterBySavingsTransfer:!1}),v=Object(i.a)(y,2),E=v[0],C=v[1],S=Object(n.useState)(null),B=Object(i.a)(S,2),T=B[0],O=B[1];return Object(n.useEffect)(()=>{try{const e=function(){try{const e=window.localStorage.getItem("savedState"),t=e?JSON.parse(e):{};return Object(o.a)({},c,{transactions:e?t.transactions:[],currentBalance:e?t.currentBalance:"",otherSavingsBalance:e?t.otherSavingsBalance:"",savingGoal:e?t.savingGoal:"",interestRate:e?t.interestRate:"0",storedCategoryMappings:e?new Map(t.storedCategoryMappings):new Map})}catch(e){console.log("Error retrieving from local storage",e.message)}}();l(e),Q(e.transactions)}catch(e){console.log("Error applying state from local storage to running application ",e.message)}},[]),r.a.createElement("div",{className:"app-page app-content"},r.a.createElement("a",{className:"hidden-input",href:"hidden",ref:t},"Hidden data download link"),r.a.createElement("div",{className:"app-header"},r.a.createElement("div",{className:"app-logo-container"},"Saving Analyst")),r.a.createElement("div",{className:"app-main-content"},r.a.createElement("div",{className:"management-panel"},r.a.createElement(h,{setRoute:function(e){f(e)},route:p}),r.a.createElement("div",{className:"management-panel-content"},function(){switch(p){case"Transactions":return r.a.createElement(b,{displayLimit:E.transactionDisplayLimit,transactions:c.transactions,filterByCategory:E.filterByCategory,filterClassified:E.filterClassified,filterByTransactionType:E.filterByTransactionType,filterBySavingsTransfer:E.filterBySavingsTransfer,currentBalance:c.currentBalance,otherSavingsBalance:c.otherSavingsBalance,savingGoal:c.savingGoal,sortBy:c.sortBy,setSortBy:H,importTransactions:w,importCategoryMappings:M,clearTransactions:D,generateCategoryMapping:j,showMoreTransactions:P,setFilterClassified:Z,setCategoryFilter:J,setTransactionTypeFilter:W,deleteTransaction:k,updateCategoryForMatchingItems:q,updateTransactionIsSaving:K,getPrediction:V,setSavingsTransferFilter:Y});case"Reports":return r.a.createElement(F,{state:c,transactions:c.transactions,currentBalance:c.currentBalance,otherSavingsBalance:c.otherSavingsBalance,interestRate:c.interestRate,savingGoal:c.savingGoal,setSavingGoal:G,setInterestRate:U,setCurrentBalance:x,setOtherSavingsBalance:L});default:return r.a.createElement("div",null,"Something went wrong!")}}()))));function A(e){try{l(e)}catch(t){return void console.log("Error saving state",t.message)}try{!function(e){try{const t={transactions:e.transactions,currentBalance:e.currentBalance,otherSavingsBalance:e.otherSavingsBalance,savingGoal:e.savingGoal,interestRate:e.interestRate,storedCategoryMappings:Array.from(e.storedCategoryMappings.entries())};window.localStorage.setItem("savedState",JSON.stringify(t))}catch(t){console.log("Error saving state to local storage",t.message)}}(e)}catch(t){return void console.log("Error saving to local storage",t.message)}}function w(e){try{N.a(e).then(e=>{const t=function(e){const t=new d.a;return e.map(e=>{let a;a=""!==e["Beguenstigter/Zahlungspflichtiger"]&&""!==e["Kontonummer/IBAN"]?e["Beguenstigter/Zahlungspflichtiger"]+"%"+e["Kontonummer/IBAN"]:e.Buchungstext;const n=t.guid(),r=u.a.utc(e.Buchungstag,"DD.MM.YY"),s=e.Betrag.replace(/,/g,".");return Object(o.a)({},e,{id:n,amount:parseFloat(s).toFixed(2),referenceString:a,bookingDate:r.toDate(),category:"Undefined",isSaving:!1})}).sort((e,t)=>e.bookingDate.valueOf()-t.bookingDate.valueOf())}(e),a=(n=c.storedCategoryMappings,t.map(e=>n.get(e.referenceString)?Object(o.a)({},e,{category:n.get(e.referenceString)}):Object(o.a)({},e,{category:"Undefined"})));var n;A(Object(o.a)({},c,{transactions:a})),Q(a)})}catch(t){console.log("Transaction import failed"+t.message)}}function D(){try{A(Object(o.a)({},c,{transactions:[],currentBalance:"",otherSavingsBalance:"",savingGoal:"",storedCategoryMappings:new Map})),z(),O(null)}catch(e){console.log("Error clearing transactions",e.message)}}function k(e){try{const t=c.transactions.filter(t=>t.id!==e);A(Object(o.a)({},c,{transactions:t}))}catch(t){console.log("Error deleting transaction",t.message)}}function j(){try{const e="data:text/json,"+encodeURIComponent(JSON.stringify({mapping:Array.from(R(c.transactions).entries()),savingsTransfers:I(c.transactions)})),a="data "+(new Date).toLocaleString()+".json",n=t.current;n.href=e,n.download=a,n.click()}catch(e){console.log("Error generating category download file: ",e.message)}}function M(e){const t=new FileReader;t.onload=e=>{const a=JSON.parse(t.result);!function(t,a){if(t)try{var n;const e=null===(n=c.transactions)||void 0===n?void 0:n.map(e=>t.get(e.referenceString)?Object(o.a)({},e,{category:t.get(e.referenceString)}):e);if(!e)throw new Error("transactions were undefined");{const t=e.map(e=>{const t=e.bookingDate,n=e.amount,r=JSON.stringify(e.referenceString+"-"+t+"-"+n);return!0===a.get(r)?Object(o.a)({},e,{isSaving:!0}):e});A(Object(o.a)({},c,{transactions:t})),Q(t)}}catch(e){return void console.log("Error applying category mappings",e.message)}else console.log("no category map found!")}(new Map(a.mapping),new Map(a.savingsTransfers))};try{t.readAsText(e)}catch(a){console.log("Error reading file: ",a.message)}}function x(e){A(Object(o.a)({},c,{currentBalance:e}))}function L(e){A(Object(o.a)({},c,{otherSavingsBalance:e}))}function G(e){A(Object(o.a)({},c,{savingGoal:e}))}function U(e){A(Object(o.a)({},c,{interestRate:e}))}function P(){const e=Object(o.a)({},E,{transactionDisplayLimit:E.transactionDisplayLimit+50});C(e)}function J(e){const t=Object(o.a)({},E,{filterByCategory:e});C(t)}function Z(e){const t=Object(o.a)({},E,{filterClassified:e,filterByCategory:""});C(t)}function W(e){const t=Object(o.a)({},E,{filterByTransactionType:e});C(t)}function Y(e){const t=Object(o.a)({},E,{filterBySavingsTransfer:e});C(t)}function K(e,t){const a=c.transactions.map(a=>a.id===e?Object(o.a)({},a,{isSaving:t}):a);A(Object(o.a)({},c,{transactions:a}))}function q(e,t){var a;const n=null===(a=c.transactions)||void 0===a?void 0:a.find(t=>t.id===e);if(n){const e=c.transactions.map(e=>e.referenceString===n.referenceString?Object(o.a)({},e,{category:t}):e),a=R(e);A(Object(o.a)({},c,{transactions:e,storedCategoryMappings:a})),z(),Q(e)}}function z(){const e=Object(o.a)({},E,{transactionDisplayLimit:50,filterByCategory:""});C(e)}function H(e){const t=Object(o.a)({},c,{sortBy:e});l(t)}function Q(e){const t=function(e){const t=function(e){return e.map(e=>({id:e.id,transactionType:e.Buchungstext,words:_(e["Beguenstigter/Zahlungspflichtiger"]),category:e.category}))}(e.filter(e=>"Undefined"!==e.category)),a=function(e){return e.reduce((e,t)=>e.includes(t.category)?e:e.concat([t.category]),[])}(t),n=function(e){const t=e.length,a=e.reduce((e,t)=>{if(e.has(t.category)){const a=e.get(t.category)+1;return e.set(t.category,a),e}return e.set(t.category,1),e},new Map);return new Map(Array.from(a).map(e=>[e[0],e[1]/t]))}(t),r=function(e){const t=(e,t)=>{const a=e.find(e=>e.word===t);if(a){const t=a.count++;return a.count=t,e}return e.concat([{word:t,count:1}])};return e.reduce((e,a)=>a.words.reduce(t,e),[])}(t),s=function(e,t,a){const n=((e,t,a)=>{const n=new Map;return t.forEach(t=>{let r=0;a.forEach(a=>{e.filter(e=>e.category===a&&e.words.includes(t.word)).length>0&&r++}),n.set(t.word,r)}),n})(e,t,a),r=new Map;return a.forEach(a=>{r.set(a,new Map);const s=e.filter(e=>e.category===a),c=s.length;t.forEach(e=>{const t=(s.filter(t=>t.words.includes(e.word)).length+.01)/c*(1/n.get(e.word));r.get(a).set(e.word,t)})}),r}(t,r,a),c=function(e){return e.reduce((e,t)=>e.includes(t.transactionType)?e:e.concat([t.transactionType]),[])}(t),o=function(e,t,a){const n=new Map;return a.forEach(a=>{n.set(a,new Map);const r=e.filter(e=>e.category===a),s=r.length;t.forEach(e=>{const t=(1+r.filter(t=>t.transactionType===e).length)/s;n.get(a).set(e,t)})}),n}(t,c,a);return e=>{if(e&&e.words){return a.map(t=>{const a=n.get(t),r=function e(a,n){if(0===a.length)return 0;if(1===a.length)return s.get(t).get(a[0])?n*s.get(t).get(a[0]):n;if(s.get(t).get(a[0])){const r=n*s.get(t).get(a[0]);return e(a.slice(1),r)}return e(a.slice(1),n)}(e.words,1);const c=o.get(t).get(e.transactionType);return{category:t,probability:a*r*c}}).sort((e,t)=>t.probability-e.probability).slice(0,1)}return{}}}(e);t&&"function"===typeof t&&O(()=>t)}function V(e){const t=c.transactions.find(t=>t.id===e),a={id:t.id,words:_(t["Beguenstigter/Zahlungspflichtiger"]),category:t.category,transactionType:t.Buchungstext};if(a){if("function"===typeof T){return T(a)}return{}}return{}}};c.a.render(r.a.createElement(L,null),document.getElementById("root"))}},[[29,1,2]]]);
//# sourceMappingURL=main.007c55fe.chunk.js.map